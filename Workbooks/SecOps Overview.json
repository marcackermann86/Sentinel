{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "55d3ab63-6e1f-4d02-8d9e-2225526689c7",
            "version": "KqlParameterItem/1.0",
            "name": "Subscription",
            "type": 6,
            "isRequired": true,
            "query": "Resources\r\n| summarize Count = count() by subscriptionId\r\n| order by Count desc\r\n| extend Rank = row_number()\r\n| project value = subscriptionId, label = subscriptionId, selected = Rank == 1",
            "typeSettings": {
              "additionalResourceOptions": [],
              "showDefault": false
            },
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange",
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources"
          },
          {
            "id": "95a45501-31b5-4ea2-bcb3-eb208e0080e2",
            "version": "KqlParameterItem/1.0",
            "name": "Workspace",
            "type": 5,
            "isRequired": true,
            "multiSelect": true,
            "quote": "'",
            "delimiter": ",",
            "typeSettings": {
              "resourceTypeFilter": {
                "microsoft.operationalinsights/workspaces": true
              },
              "additionalResourceOptions": [],
              "showDefault": false
            },
            "timeContextFromParameter": "TimeRange",
            "value": [
              
            ]
          }
        ],
        "style": "pills",
        "queryType": 1,
        "resourceType": "microsoft.resourcegraph/resources"
      },
      "name": "parameters - 7"
    },
    {
      "type": 1,
      "content": {
        "json": "<h3>Select a tab and set the incident creation time depending on the incidents you'd like to review. The filters can then be used to narrow the results further.</h3>",
        "style": "upsell"
      },
      "name": "text - 4"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "7d597ad7-4a2a-45ed-a4fe-7ee32de0fc22",
            "version": "KqlParameterItem/1.0",
            "name": "TimeRange",
            "label": "Incident Creation Time",
            "type": 4,
            "isRequired": true,
            "typeSettings": {
              "selectableValues": [
                {
                  "durationMs": 86400000
                },
                {
                  "durationMs": 172800000
                },
                {
                  "durationMs": 259200000
                },
                {
                  "durationMs": 604800000
                },
                {
                  "durationMs": 1209600000
                },
                {
                  "durationMs": 2592000000
                },
                {
                  "durationMs": 5184000000
                },
                {
                  "durationMs": 7776000000
                }
              ],
              "allowCustom": true
            },
            "value": {
              "durationMs": 604800000
            }
          },
          {
            "id": "f616852f-5fef-4c61-98f2-15b90d1a39d9",
            "version": "KqlParameterItem/1.0",
            "name": "Provider",
            "type": 2,
            "isRequired": true,
            "multiSelect": true,
            "quote": "'",
            "delimiter": ",",
            "query": "SecurityIncident\r\n| where CreatedTime >= ago(14d)\r\n| where isnotempty(ProviderName)\r\n| distinct ProviderName\r\n| sort by ProviderName asc\r\n",
            "typeSettings": {
              "additionalResourceOptions": [
                "value::all"
              ],
              "selectAllValue": "*",
              "showDefault": false
            },
            "defaultValue": "value::all",
            "queryType": 0,
            "resourceType": "microsoft.operationalinsights/workspaces"
          },
          {
            "id": "cf86113b-59ad-4fc9-aeb7-9b44e230641e",
            "version": "KqlParameterItem/1.0",
            "name": "Product",
            "type": 2,
            "isRequired": true,
            "isGlobal": true,
            "multiSelect": true,
            "quote": "'",
            "delimiter": ",",
            "query": "SecurityIncident\r\n| where CreatedTime >= ago(14d)\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where isnotempty(Product)\r\n| distinct Product\r\n| sort by Product asc\r\n",
            "typeSettings": {
              "additionalResourceOptions": [
                "value::all"
              ],
              "selectAllValue": "*",
              "showDefault": false
            },
            "defaultValue": "value::all",
            "queryType": 0,
            "resourceType": "microsoft.operationalinsights/workspaces",
            "value": [
              "value::all"
            ]
          },
          {
            "id": "3a87d4f7-42cc-4c62-b543-6b5d9ab8cf27",
            "version": "KqlParameterItem/1.0",
            "name": "Severity",
            "type": 2,
            "isRequired": true,
            "multiSelect": true,
            "quote": "'",
            "delimiter": ",",
            "typeSettings": {
              "additionalResourceOptions": [
                "value::all"
              ],
              "selectAllValue": "*",
              "showDefault": false
            },
            "jsonData": "[\"High\", \"Medium\", \"Low\", \"Informational\"]",
            "timeContext": {
              "durationMs": 86400000
            },
            "timeContextFromParameter": "TimeRange",
            "defaultValue": "value::all"
          },
          {
            "id": "81085d3a-5aca-488e-b7c6-ecf1167e59f7",
            "version": "KqlParameterItem/1.0",
            "name": "Tactics",
            "type": 2,
            "isRequired": true,
            "multiSelect": true,
            "quote": "'",
            "delimiter": ",",
            "query": "SecurityIncident\r\n| where CreatedTime >= ago(14d)\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-expand Tactics to typeof(string)\r\n| where isnotempty(Tactics)\r\n| distinct Tactics\r\n| sort by Tactics asc",
            "typeSettings": {
              "additionalResourceOptions": [
                "value::all"
              ],
              "selectAllValue": "*",
              "showDefault": false
            },
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange",
            "defaultValue": "value::all",
            "queryType": 0,
            "resourceType": "microsoft.operationalinsights/workspaces"
          },
          {
            "id": "0f9efb0d-ac34-41d0-8a19-165840eb2a71",
            "version": "KqlParameterItem/1.0",
            "name": "Owner",
            "type": 2,
            "isRequired": true,
            "multiSelect": true,
            "quote": "'",
            "delimiter": ",",
            "query": "SecurityIncident\r\n| where CreatedTime >= ago(14d)\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where isnotempty(Owner)\r\n| distinct Owner\r\n| sort by Owner asc",
            "typeSettings": {
              "additionalResourceOptions": [
                "value::all"
              ],
              "selectAllValue": "*",
              "showDefault": false
            },
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange",
            "defaultValue": "value::all",
            "queryType": 0,
            "resourceType": "microsoft.operationalinsights/workspaces"
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "name": "parameters - 6"
    },
    {
      "type": 11,
      "content": {
        "version": "LinkItem/1.0",
        "style": "tabs",
        "tabStyle": "bigger",
        "links": [
          {
            "id": "0ded806f-d31d-41dd-b884-5c5de29d4376",
            "cellValue": "Tab",
            "linkTarget": "parameter",
            "linkLabel": "All Incidents",
            "subTarget": "all",
            "style": "link",
            "tabWidth": "150px"
          },
          {
            "id": "2d6feb1f-0102-40cd-93be-7f80bc1a85fe",
            "cellValue": "Tab",
            "linkTarget": "parameter",
            "linkLabel": "Incidents (No DLP/Phishing)",
            "subTarget": "non-dlp",
            "style": "link",
            "tabWidth": "220px"
          },
          {
            "id": "915889d9-9d34-4dee-a44b-8555ceb2f462",
            "cellValue": "Tab",
            "linkTarget": "parameter",
            "linkLabel": "Phishing Incidents",
            "subTarget": "phish",
            "style": "link",
            "tabWidth": "150px"
          },
          {
            "id": "cf5a24f8-096d-42e4-9d26-594db4d9643e",
            "cellValue": "Tab",
            "linkTarget": "parameter",
            "linkLabel": "Log Ingestion",
            "subTarget": "log",
            "style": "link",
            "tabWidth": "150px"
          },
          {
            "id": "e1db8ad2-80a1-49e3-908a-1a38e25bc5d1",
            "cellValue": "Tab",
            "linkTarget": "parameter",
            "linkLabel": "DLP Incidents",
            "subTarget": "dlp",
            "style": "link",
            "tabWidth": "150px"
          }
        ]
      },
      "name": "links - 14",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Owner = tostring(Owner.assignedTo)\n| where not(Status == 'Closed' and isempty(Owner))\n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\n| where Product in ({Product}) or \"*\" in ({Product})\n| extend Tactics = todynamic(AdditionalData.tactics)\n| mv-apply Tactics to typeof(string) on (\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n    | summarize make_set(Tactics))\n| summarize count() by bin(CreatedTime, max_of({TimeRange:grain}, 1h)), Severity",
              "size": 0,
              "title": "Incidents Created Over Time",
              "timeContextFromParameter": "TimeRange",
              "timeBrushParameterName": "TimeRange",
              "timeBrushExportOnlyWhenBrushed": true,
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "barchart",
              "gridSettings": {
                "sortBy": [
                  {
                    "itemKey": "CreatedTime",
                    "sortOrder": 2
                  }
                ]
              },
              "sortBy": [
                {
                  "itemKey": "CreatedTime",
                  "sortOrder": 2
                }
              ],
              "chartSettings": {
                "seriesLabelSettings": [
                  {
                    "seriesName": "count_",
                    "label": "Incidents"
                  }
                ],
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 17,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "Incidents over time ",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\n| where Status == 'Closed'\n| summarize arg_min(TimeGenerated, *) by IncidentNumber\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Owner = tostring(Owner.assignedTo)\n| where not(Status == 'Closed' and isempty(Owner))\n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\n| where Product in ({Product}) or \"*\" in ({Product})\n| extend Tactics = todynamic(AdditionalData.tactics)\n| mv-apply Tactics to typeof(string) on (\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n    | summarize make_set(Tactics))\n| summarize count() by bin(ClosedTime, max_of({TimeRange:grain}, 1h)), Severity",
              "size": 0,
              "title": "Incidents Closed Over Time",
              "color": "green",
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "barchart",
              "gridSettings": {
                "sortBy": [
                  {
                    "itemKey": "CreatedTime",
                    "sortOrder": 2
                  }
                ]
              },
              "sortBy": [
                {
                  "itemKey": "CreatedTime",
                  "sortOrder": 2
                }
              ],
              "chartSettings": {
                "seriesLabelSettings": [
                  {
                    "seriesName": "count_",
                    "label": "Incidents"
                  },
                  {
                    "seriesName": "Low",
                    "color": "grayBlue"
                  },
                  {
                    "seriesName": "Medium",
                    "color": "amethyst"
                  },
                  {
                    "seriesName": "High",
                    "color": "gray"
                  }
                ]
              }
            },
            "customWidth": "50",
            "name": "Incidents over time  - Copy",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Owner = tostring(Owner.assignedTo)\n| where not(Status == 'Closed' and isempty(Owner))\n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\n| where Product in ({Product}) or \"*\" in ({Product})\n| extend Tactics = todynamic(AdditionalData.tactics)\n| mv-apply Tactics to typeof(string) on (\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n    | summarize make_set(Tactics))\n| where Status == 'Closed'\n| extend feedback = strcat(Classification,\": \",ClassificationReason)\n| extend feedback = case(feedback == 'TruePositive: SuspiciousActivity', 'True Positive: Suspicious activity',\n                         feedback == 'BenignPositive: SuspiciousButExpected', 'Benign Positive: Suspicious but expected',\n                         feedback == 'FalsePositive: IncorrectAlertLogic', 'False Positive: Incorrect alert logic',\n                         feedback == 'FalsePositive: InaccurateData', 'False Positive: Inaccurate data',\n                         'Undetermined')\n| summarize Count=count() by feedback\n| sort by Count desc\n",
              "size": 0,
              "title": "Incidents by Closing Classification",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "piechart",
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "feedback",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "Count",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "Incidents by classification - headline",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let base = SecurityIncident\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Owner = tostring(Owner.assignedTo)\n| where not(Status == 'Closed' and isempty(Owner))\n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\n| where Product in ({Product}) or \"*\" in ({Product})\n| extend Tactics = todynamic(AdditionalData.tactics)\n| mv-apply Tactics to typeof(string) on (\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n    | summarize make_set(Tactics))\n| where Status == 'Closed'\n| extend feedback = strcat(Classification,\": \",ClassificationReason)\n| extend feedback = case(feedback == 'TruePositive: SuspiciousActivity', 'True Positive',\n                         feedback == 'BenignPositive: SuspiciousButExpected', 'Benign Positive',\n                         feedback == 'FalsePositive: IncorrectAlertLogic', 'False Positive',\n                         feedback == 'FalsePositive: InaccurateData', 'False Positive',\n                         'Undetermined');\nlet Total=toscalar(base | summarize count());\nlet History=base\n| make-series SparkData=count() default=0 on TimeGenerated in range({TimeRange:start}, {TimeRange:end}, {TimeRange:grain}) by feedback;\nbase\n| summarize Count=count() by feedback\n| extend Percent=Count / toreal(Total)\n| sort by Percent desc\n| join History on feedback\n",
              "size": 0,
              "title": "Closing Classification Distribution",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "tiles",
              "tileSettings": {
                "titleContent": {
                  "columnMatch": "feedback",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "Percent",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "style": "percent",
                      "maximumFractionDigits": 2,
                      "maximumSignificantDigits": 3
                    }
                  }
                },
                "secondaryContent": {
                  "columnMatch": "SparkData",
                  "formatter": 9,
                  "formatOptions": {
                    "palette": "pink"
                  }
                },
                "showBorder": false
              },
              "chartSettings": {
                "yAxis": [
                  "Percent"
                ],
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 0,
                    "options": {
                      "style": "percent",
                      "useGrouping": true
                    },
                    "missingSparkDataOption": "Zero"
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "Incidents by classification - headline - Copy",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Owner = tostring(Owner.assignedTo)\n| where not(Status == 'Closed' and isempty(Owner))\n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\n| where Product in ({Product}) or \"*\" in ({Product})\n| extend Tactics = todynamic(AdditionalData.tactics)\n| mv-apply Tactics to typeof(string) on (\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n    | summarize make_set(Tactics))\n| where Status == 'Closed'\n| extend feedback = strcat(Classification,\": \",ClassificationReason)\n| extend feedback = case(feedback == 'TruePositive: SuspiciousActivity', 'True Positive',\n                         feedback == 'BenignPositive: SuspiciousButExpected', 'Benign Positive',\n                         feedback == 'FalsePositive: IncorrectAlertLogic', 'False Positive',\n                         feedback == 'FalsePositive: InaccurateData', 'False Positive',\n                         'Undetermined')\n| where feedback == \"False Positive\"\n| summarize Count=count() by Title\n| sort by Count desc\n",
              "size": 0,
              "title": "False Positive Incidents by Title",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "table",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Count",
                    "formatter": 3,
                    "formatOptions": {
                      "palette": "blue"
                    }
                  }
                ]
              },
              "tileSettings": {
                "titleContent": {
                  "columnMatch": "feedback",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "Percent",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "style": "percent",
                      "maximumFractionDigits": 2,
                      "maximumSignificantDigits": 3
                    }
                  }
                },
                "secondaryContent": {
                  "columnMatch": "SparkData",
                  "formatter": 9,
                  "formatOptions": {
                    "palette": "pink"
                  }
                },
                "showBorder": false
              },
              "chartSettings": {
                "yAxis": [
                  "Percent"
                ],
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 0,
                    "options": {
                      "style": "percent",
                      "useGrouping": true
                    },
                    "missingSparkDataOption": "Zero"
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "Incidents by classification - headline - Copy - Copy",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\r\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| where isempty(Owner) and Status == 'Closed'\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize Tactics=make_set(Tactics))\r\n| project CreatedTime, IncidentNumber, Title, Severity, ModifiedBy, Status, Classification, ClassificationComment, ProviderName, Product, Tactics\r\n//| summarize count() by bin(CreatedTime, {TimeRange:grain})",
              "size": 0,
              "title": "Incidents Closed by Automation",
              "noDataMessage": "No recent incidents closed by Automation",
              "noDataMessageStyle": 3,
              "timeContext": {
                "durationMs": 86400000
              },
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Severity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Low",
                          "representation": "Sev3",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Medium",
                          "representation": "Sev2",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "High",
                          "representation": "Sev1",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Sev4",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  }
                ]
              },
              "graphSettings": {
                "type": 0
              }
            },
            "customWidth": "50",
            "name": "query - 13",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let base = SecurityIncident\r\n| where TimeGenerated between ({TimeRange:start} .. {TimeRange:end}) and Status == \"New\"\r\n| summarize arg_min(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize make_set(Tactics))\r\n| project CreatedTime=TimeGenerated, IncidentNumber, Severity\r\n| join (SecurityIncident\r\n| where TimeGenerated between ({TimeRange:start} .. {TimeRange:end})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where isnotempty(Owner)\r\n| summarize arg_min(TimeGenerated, *) by IncidentNumber\r\n| project IncidentNumber, LastModifiedTime, Owner) on IncidentNumber\r\n| extend ttt = datetime_diff('second', LastModifiedTime, CreatedTime);\r\nunion (base | summarize ['Number of Incidents']=count(), MeanTTT=round(avg(ttt), 0) | extend Severity = 'All'),\r\n      (base | summarize ['Number of Incidents']=count(), MeanTTT=round(avg(ttt), 0) by Severity)\r\n| mv-apply ttt = split(split(MeanTTT * 1s, '.')[0], ':') on (\r\n    summarize ttt = make_list(toint(iff(ttt startswith \"0\", trim_start(\"0\", tostring(ttt)), ttt))))\r\n| extend ['Mean Time to Triage'] = strcat(iff(ttt[0] > 0, strcat(ttt[0], \" hours \"), \"\"), iff(ttt[1] > 0, strcat(ttt[1], \" minutes \"), \"\"), iff(ttt[2] > 0, strcat(ttt[2], \" seconds\"), \"\"))\r\n| extend tempSeverity = case (Severity == 'All', 0, Severity == 'High', 1, Severity == 'Medium', 2,  Severity == 'Low', 3, Severity == 'informational', 4, 5)\r\n| project SeverityAndCount = strcat(Severity, ' - ', ['Number of Incidents']), Severity, ['Number of Incidents'], ['Mean Time to Triage'], MeanTTT = MeanTTT / 60, tempSeverity\r\n| sort by tempSeverity asc",
                          "size": 4,
                          "title": "Mean Time to Triage",
                          "showRefreshButton": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SeverityAndCount",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "MeanTTT",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 25,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 1
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Mean Time to Triage",
                              "formatter": 1
                            },
                            "showBorder": false,
                            "sortCriteriaField": "tempSeverity",
                            "sortOrderField": 1,
                            "size": "auto"
                          },
                          "graphSettings": {
                            "type": 0
                          },
                          "mapSettings": {
                            "locInfo": "LatLong",
                            "sizeSettings": "50th_Percentile",
                            "sizeAggregation": "Sum",
                            "legendMetric": "50th_Percentile",
                            "legendAggregation": "Sum",
                            "itemColorSettings": {
                              "type": "heatmap",
                              "colorAggregation": "Sum",
                              "nodeColorField": "50th_Percentile",
                              "heatmapPalette": "greenRed"
                            }
                          }
                        },
                        "name": "MTTT",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let base = SecurityIncident\r\n| where TimeGenerated between ({TimeRange:start} .. {TimeRange:end}) and Status == \"New\"\r\n| summarize arg_min(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize make_set(Tactics))\r\n| project CreatedTime=TimeGenerated, CreatedTimeLocal=datetime_utc_to_local(TimeGenerated, \"US/Eastern\"), IncidentNumber, Severity\r\n| join (SecurityIncident\r\n| where TimeGenerated between ({TimeRange:start} .. {TimeRange:end})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where isnotempty(Owner)\r\n| summarize arg_min(TimeGenerated, *) by IncidentNumber\r\n| project IncidentNumber, LastModifiedTime, Owner) on IncidentNumber\r\n| extend ttt = datetime_diff('second', LastModifiedTime, CreatedTime);\r\nunion (base | where datetime_part('hour', CreatedTimeLocal) between (6 .. 15) | summarize ['Number of Incidents']=count(), MeanTTT=round(avg(ttt), 0) by Shift = \"6am to 3pm\"),\r\n      (base | where datetime_part('hour', CreatedTimeLocal) between (8 .. 17) | summarize ['Number of Incidents']=count(), MeanTTT=round(avg(ttt), 0) by Shift = \"8am to 5pm\"),\r\n      (base | where datetime_part('hour', CreatedTimeLocal) between (14 .. 23) | summarize ['Number of Incidents']=count(), MeanTTT=round(avg(ttt), 0) by Shift = \"2pm to 11pm\"),\r\n      (base | where datetime_part('hour', CreatedTimeLocal) between (0 .. 7) or datetime_part('hour', CreatedTimeLocal) between (22 .. 24) | summarize ['Number of Incidents']=count(), MeanTTT=round(avg(ttt), 0) by Shift = \"10pm to 7am\")\r\n| mv-apply ttt = split(split(MeanTTT * 1s, '.')[0], ':') on (\r\n    summarize ttt = make_list(toint(iff(ttt startswith \"0\", trim_start(\"0\", tostring(ttt)), ttt))))\r\n| extend ['Mean Time to Triage'] = strcat(iff(ttt[0] > 0, strcat(ttt[0], \" hours \"), \"\"), iff(ttt[1] > 0, strcat(ttt[1], \" minutes \"), \"\"), iff(ttt[2] > 0, strcat(ttt[2], \" seconds\"), \"\"))\r\n| extend tempShift = case (Shift == '6am to 3pm', 1, Shift == '8am to 5pm', 2,  Shift == '2pm to 11pm', 3, Shift == '10pm to 7am', 4, 5)\r\n| project ShiftAndCount = strcat(Shift, ' - ', ['Number of Incidents']), Shift, ['Number of Incidents'], ['Mean Time to Triage'], MeanTTT = MeanTTT / 60, tempShift\r\n| sort by tempShift asc",
                          "size": 4,
                          "title": "Mean Time to Triage by Shift",
                          "showRefreshButton": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "ShiftAndCount",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "MeanTTT",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 25,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 1
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Mean Time to Triage",
                              "formatter": 1
                            },
                            "showBorder": false,
                            "sortCriteriaField": "tempSeverity",
                            "sortOrderField": 1,
                            "size": "auto"
                          },
                          "graphSettings": {
                            "type": 0
                          },
                          "mapSettings": {
                            "locInfo": "LatLong",
                            "sizeSettings": "50th_Percentile",
                            "sizeAggregation": "Sum",
                            "legendMetric": "50th_Percentile",
                            "legendAggregation": "Sum",
                            "itemColorSettings": {
                              "type": "heatmap",
                              "colorAggregation": "Sum",
                              "nodeColorField": "50th_Percentile",
                              "heatmapPalette": "greenRed"
                            }
                          }
                        },
                        "name": "MTTT by Shift",
                        "styleSettings": {
                          "showBorder": true
                        }
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 3"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let base = SecurityIncident\r\n| where TimeGenerated between ({TimeRange:start} .. {TimeRange:end}) and Status == \"New\"\r\n| summarize arg_min(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize make_set(Tactics))\r\n| project CreatedTime=TimeGenerated, IncidentNumber, Severity\r\n| join (SecurityIncident\r\n| where TimeGenerated between ({TimeRange:start} .. {TimeRange:end})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where isnotempty(Owner)\r\n| summarize arg_min(TimeGenerated, *) by IncidentNumber\r\n| project IncidentNumber, LastModifiedTime, Owner) on IncidentNumber\r\n| extend ttt = datetime_diff('second', LastModifiedTime, CreatedTime);\r\nunion (base | summarize ['Number of Incidents']=count(), MeanTTT=round(avg(ttt), 0) | extend Owner = 'All'),\r\n      (base | summarize ['Number of Incidents']=count(), MeanTTT=round(avg(ttt), 0) by Owner | sort by Owner asc)\r\n| mv-apply ttt = split(split(MeanTTT * 1s, '.')[0], ':') on (\r\n    summarize ttt = make_list(toint(iff(ttt startswith \"0\", trim_start(\"0\", tostring(ttt)), ttt))))\r\n| extend ['Mean Time to Triage'] = strcat(iff(ttt[0] > 0, strcat(ttt[0], \" hours \"), \"\"), iff(ttt[1] > 0, strcat(ttt[1], \" minutes \"), \"\"), iff(ttt[2] > 0, strcat(ttt[2], \" seconds\"), \"\"))\r\n| project OwnerAndCount = strcat(Owner, ' - ', ['Number of Incidents']), Owner, ['Number of Incidents'], ['Mean Time to Triage'], MeanTTT = MeanTTT / 60",
                    "size": 0,
                    "title": "Mean Time to Triage by Owner",
                    "showRefreshButton": true,
                    "exportFieldName": "series",
                    "exportParameterName": "Status",
                    "exportDefaultValue": "All",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "OwnerAndCount",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "MeanTTT",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "auto"
                        },
                        "numberFormat": {
                          "unit": 25,
                          "options": {
                            "style": "decimal",
                            "useGrouping": false,
                            "maximumFractionDigits": 1
                          }
                        }
                      },
                      "secondaryContent": {
                        "columnMatch": "Mean Time to Triage"
                      },
                      "showBorder": false
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 2 - Copy",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "name": "group - 13"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "SLA Evaluation",
              "items": [
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": ""
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "<h3>The time to triage for each incident is evaluated against the Time to Triage SLA Chart below and then assigned a color value. These colors represent how close the time to triage was to meeting the SLA threshold.</h3>\r\n<h4>Green = within SLA\r\n</br>Amber = missed SLA by small margin\r\n</br>Red = missed SLA by large margin</h4>",
                          "style": "upsell"
                        },
                        "name": "sla_group_table_title",
                        "styleSettings": {
                          "margin": "10px"
                        }
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": ""
                        },
                        "customWidth": "8",
                        "name": "text - 3"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "<h4>Time to Triage SLA Chart</h4>\r\n<table>\r\n <thead>\r\n  <tr><th>Severity</th><th>Green</th><th>Amber</th><th>Red</th></tr>\r\n </thead>\r\n <tbody>\r\n <tr><td>High</td><td>< 15 minutes</td><td><= 20 minutes</td><td>> 20 minutes</td></tr>\r\n <tr><td>Medium</td><td>< 30 minutes</td><td><= 45 minutes</td><td>> 45 minutes</td></tr>\r\n <tr><td>Low</td><td>< 120 minutes</td><td><= 180 minutes</td><td>> 180 minutes</td></tr>\r\n <tr><td>Informational</td><td>< 120 minutes</td><td><= 180 minutes</td><td>> 180 minutes</td></tr>\r\n </tbody>\r\n</table>"
                        },
                        "customWidth": "85",
                        "name": "text - 0",
                        "styleSettings": {
                          "margin": "10px"
                        }
                      }
                    ]
                  },
                  "customWidth": "35",
                  "name": "group - 4",
                  "styleSettings": {
                    "margin": "10px"
                  }
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 3"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let base = SecurityIncident\r\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where isnotempty(Owner)\r\n| summarize arg_min(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize make_set(Tactics))\r\n| extend TimeToTriage = datetime_diff('second', LastModifiedTime, CreatedTime)\r\n| extend SLA = LookupSLA(Severity, TimeToTriage/60.0);\r\ndatatable ( Severity:string, SLA:string ) [ \r\n    \"High\", \"\",\r\n    \"High\", \"Green\",\r\n    \"High\", \"Amber\",\r\n    \"High\", \"Red\",\r\n    \"Medium\", \"\",\r\n    \"Medium\", \"Green\",\r\n    \"Medium\", \"Amber\",\r\n    \"Medium\", \"Red\",\r\n    \"Low\", \"\",\r\n    \"Low\", \"Green\",\r\n    \"Low\", \"Amber\",\r\n    \"Low\", \"Red\",\r\n    \"Informational\", \"\",\r\n    \"Informational\", \"Green\",\r\n    \"Informational\", \"Amber\",\r\n    \"Informational\", \"Red\"\r\n]\r\n| lookup kind=leftouter (base\r\n| project IncidentNumber, Severity, CreatedTime, FirstModifiedTime, LastModifiedTime, Owner, ModifiedBy, SLA\r\n| summarize Incidents = count() by Severity, SLA\r\n| lookup kind=leftouter (base\r\n| summarize Total = count() by Severity) on Severity\r\n| union (base\r\n| project IncidentNumber, Severity, CreatedTime, FirstModifiedTime, LastModifiedTime, Owner, ModifiedBy, SLA\r\n| summarize Incidents = count() by Severity)) on Severity, SLA\r\n| extend ExportColumn = strcat(Severity, '-', SLA)\r\n| extend Incidents = coalesce(Incidents, 0), Total = iff(isnotempty(SLA), coalesce(Total, 1), int(null))\r\n| extend Percent = Incidents / todouble(Total)\r\n| extend SevRank = case(Severity==\"High\", 1, Severity==\"Medium\", 2, Severity==\"Low\", 3, Severity==\"Informational\", 4, 5)\r\n| extend SlaRank = case(SLA==\"Green\", 1, SLA==\"Amber\", 2, SLA==\"Red\", 3, 0)\r\n| extend Severity = case(Severity==\"High\", strcat('ðŸŸ¥ ', Severity), Severity==\"Medium\", strcat('ðŸŸ§ ', Severity), Severity==\"Low\", strcat('ðŸŸ¨ ', Severity), Severity==\"Informational\", strcat('â¬œ ', Severity), Severity)\r\n| extend Incidents = iff(isempty(SLA), strcat(\"Total = \", tostring(Incidents)), tostring(Incidents))\r\n| sort by SevRank asc, SlaRank asc\r\n| extend Severity = coalesce(SLA, Severity)\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
                    "size": 3,
                    "title": "SLA by Severity",
                    "timeContextFromParameter": "TimeRange",
                    "exportFieldName": "ExportColumn",
                    "exportParameterName": "SelectedSLA",
                    "exportDefaultValue": "*",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Severity",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Green",
                                "representation": "dot-green",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Amber",
                                "representation": "dot-orange",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Red",
                                "representation": "dot-red",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "regex",
                                "thresholdValue": ".*",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{0}{1}"
                              }
                            ],
                            "customColumnWidthSetting": "20ch"
                          }
                        },
                        {
                          "columnMatch": "SLA",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "Incidents",
                          "formatter": 2,
                          "formatOptions": {
                            "customColumnWidthSetting": "15ch"
                          }
                        },
                        {
                          "columnMatch": "Total",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "ExportColumn",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "Percent",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "15ch"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "percent"
                            }
                          }
                        },
                        {
                          "columnMatch": "SevRank",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "SlaRank",
                          "formatter": 5
                        }
                      ],
                      "labelSettings": [
                        {
                          "columnId": "Severity",
                          "label": "Severity / SLA"
                        }
                      ]
                    }
                  },
                  "customWidth": "60",
                  "name": "sla_query",
                  "styleSettings": {
                    "margin": "10px",
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let Selected = '{SelectedSLA}';\r\nlet SelectedSeverity = tostring(coalesce(split(Selected, '-')[0], split(Selected, '-')[1]));\r\nlet SelectedSLA = iff(isnotempty(split(Selected, '-')[1]), tostring(split(Selected, '-')[1]), '*');\r\nlet base = SecurityIncident\r\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where isnotempty(Owner)\r\n| summarize arg_min(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize make_set(Tactics))\r\n| extend TimeToTriage = datetime_diff('second', LastModifiedTime, CreatedTime)\r\n| extend SLA = LookupSLA(Severity, TimeToTriage/60.0);\r\nbase\r\n| where Severity == SelectedSeverity and (SLA ==  SelectedSLA or SelectedSLA == '*')\r\n| project SLA, IncidentNumber, Severity, Title, Owner, CreatedTime, FirstModifiedTime=LastModifiedTime, TimeToTriage, IncidentUrl",
                    "size": 3,
                    "title": "SLA Incident Drilldown",
                    "noDataMessage": "No incidents for the selected severity / SLA",
                    "noDataMessageStyle": 3,
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "SLA",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Green",
                                "representation": "dot-green",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Amber",
                                "representation": "dot-orange",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Red",
                                "representation": "dot-red",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "dot-gray",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Severity",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "20ch"
                          }
                        },
                        {
                          "columnMatch": "Title",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "70ch"
                          }
                        },
                        {
                          "columnMatch": "TimeToTriage",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "20ch"
                          },
                          "numberFormat": {
                            "unit": 24,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "IncidentUrl",
                          "formatter": 7,
                          "formatOptions": {
                            "linkTarget": "Url",
                            "linkLabel": "Link",
                            "customColumnWidthSetting": "20ch"
                          }
                        }
                      ],
                      "sortBy": [
                        {
                          "itemKey": "$gen_number_TimeToTriage_7",
                          "sortOrder": 2
                        }
                      ]
                    },
                    "sortBy": [
                      {
                        "itemKey": "$gen_number_TimeToTriage_7",
                        "sortOrder": 2
                      }
                    ]
                  },
                  "name": "sla_drilldown",
                  "styleSettings": {
                    "margin": "10px",
                    "showBorder": true
                  }
                }
              ]
            },
            "name": "sla_group",
            "styleSettings": {
              "margin": "10px",
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let base = SecurityIncident\r\n| where TimeGenerated between ({TimeRange:start} .. {TimeRange:end}) and Status == \"Closed\"\r\n| summarize arg_min(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize make_set(Tactics))\r\n| project ClosedTime, IncidentNumber, Severity\r\n| join (SecurityIncident\r\n| where TimeGenerated between ({TimeRange:start} .. {TimeRange:end}) and Status == \"New\"\r\n| summarize arg_min(TimeGenerated, *) by IncidentNumber\r\n| project IncidentNumber, CreatedTime=TimeGenerated) on IncidentNumber\r\n| extend ttc = datetime_diff('second', ClosedTime, CreatedTime);\r\nunion (base | summarize ['Number of Incidents']=count(), MeanTTC=round(avg(ttc), 0) | extend Severity = 'All'),\r\n      (base | summarize ['Number of Incidents']=count(), MeanTTC=round(avg(ttc), 0) by Severity)\r\n| mv-apply ttc = split(split(MeanTTC * 1s, '.')[0], ':') on (\r\n    summarize ttc = make_list(toint(iff(ttc startswith \"0\", trim_start(\"0\", tostring(ttc)), ttc))))\r\n| extend ['Mean Time to Close'] = strcat(iff(ttc[0] > 0, strcat(ttc[0], \" hours \"), \"\"), iff(ttc[1] > 0, strcat(ttc[1], \" minutes \"), \"\"), iff(ttc[2] > 0, strcat(ttc[2], \" seconds\"), \"\"))\r\n| extend tempSeverity = case (Severity == 'All', 0, Severity == 'High', 1, Severity == 'Medium', 2,  Severity == 'Low', 3, Severity == 'informational', 4, 5)\r\n| project SeverityAndCount = strcat(Severity, ' - ', ['Number of Incidents']), Severity, ['Number of Incidents'], ['Mean Time to Close'], MeanTTC = MeanTTC / 60, tempSeverity\r\n| sort by tempSeverity asc",
                          "size": 4,
                          "title": "Mean Time to Close",
                          "showRefreshButton": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "SeverityAndCount",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "MeanTTC",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 25,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 1
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Mean Time to Close",
                              "formatter": 1
                            },
                            "showBorder": false,
                            "sortCriteriaField": "tempSeverity",
                            "sortOrderField": 1,
                            "size": "auto"
                          },
                          "graphSettings": {
                            "type": 0
                          },
                          "mapSettings": {
                            "locInfo": "LatLong",
                            "sizeSettings": "50th_Percentile",
                            "sizeAggregation": "Sum",
                            "legendMetric": "50th_Percentile",
                            "legendAggregation": "Sum",
                            "itemColorSettings": {
                              "type": "heatmap",
                              "colorAggregation": "Sum",
                              "nodeColorField": "50th_Percentile",
                              "heatmapPalette": "greenRed"
                            }
                          }
                        },
                        "name": "MTTC",
                        "styleSettings": {
                          "showBorder": true
                        }
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "let base = SecurityIncident\r\n| where TimeGenerated between ({TimeRange:start} .. {TimeRange:end}) and Status == \"Closed\"\r\n| summarize arg_min(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize make_set(Tactics))\r\n| project ClosedTime, IncidentNumber, Severity\r\n| join (SecurityIncident\r\n| where TimeGenerated between ({TimeRange:start} .. {TimeRange:end}) and Status == \"New\"\r\n| summarize arg_min(TimeGenerated, *) by IncidentNumber\r\n| project IncidentNumber, CreatedTime=TimeGenerated, CreatedTimeLocal=datetime_utc_to_local(TimeGenerated, \"US/Eastern\")) on IncidentNumber\r\n| extend ttc = datetime_diff('second', ClosedTime, CreatedTime);\r\nunion (base | where datetime_part('hour', CreatedTimeLocal) between (6 .. 15) | summarize ['Number of Incidents']=count(), MeanTTC=round(avg(ttc), 0) by Shift = \"6am to 3pm\"),\r\n      (base | where datetime_part('hour', CreatedTimeLocal) between (8 .. 17) | summarize ['Number of Incidents']=count(), MeanTTC=round(avg(ttc), 0) by Shift = \"8am to 5pm\"),\r\n      (base | where datetime_part('hour', CreatedTimeLocal) between (14 .. 23) | summarize ['Number of Incidents']=count(), MeanTTC=round(avg(ttc), 0) by Shift = \"2pm to 11pm\"),\r\n      (base | where datetime_part('hour', CreatedTimeLocal) between (0 .. 7) or datetime_part('hour', CreatedTimeLocal) between (22 .. 24) | summarize ['Number of Incidents']=count(), MeanTTC=round(avg(ttc), 0) by Shift = \"10pm to 7am\")\r\n| mv-apply ttc = split(split(MeanTTC * 1s, '.')[0], ':') on (\r\n    summarize ttc = make_list(toint(iff(ttc startswith \"0\", trim_start(\"0\", tostring(ttc)), ttc))))\r\n| extend ['Mean Time to Close'] = strcat(iff(ttc[0] > 0, strcat(ttc[0], \" hours \"), \"\"), iff(ttc[1] > 0, strcat(ttc[1], \" minutes \"), \"\"), iff(ttc[2] > 0, strcat(ttc[2], \" seconds\"), \"\"))\r\n| extend tempShift = case (Shift == '6am to 3pm', 1, Shift == '8am to 5pm', 2,  Shift == '2pm to 11pm', 3, Shift == '10pm to 7am', 4, 5)\r\n| project ShiftAndCount = strcat(Shift, ' - ', ['Number of Incidents']), Shift, ['Number of Incidents'], ['Mean Time to Close'], MeanTTC = MeanTTC / 60, tempShift\r\n| sort by tempShift asc",
                          "size": 4,
                          "title": "Mean Time to Close by Shift",
                          "showRefreshButton": true,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "visualization": "tiles",
                          "tileSettings": {
                            "titleContent": {
                              "columnMatch": "ShiftAndCount",
                              "formatter": 1
                            },
                            "leftContent": {
                              "columnMatch": "MeanTTC",
                              "formatter": 12,
                              "formatOptions": {
                                "palette": "auto"
                              },
                              "numberFormat": {
                                "unit": 25,
                                "options": {
                                  "style": "decimal",
                                  "maximumFractionDigits": 1
                                }
                              }
                            },
                            "secondaryContent": {
                              "columnMatch": "Mean Time to Close",
                              "formatter": 1
                            },
                            "showBorder": false,
                            "sortCriteriaField": "tempSeverity",
                            "sortOrderField": 1,
                            "size": "auto"
                          },
                          "graphSettings": {
                            "type": 0
                          },
                          "mapSettings": {
                            "locInfo": "LatLong",
                            "sizeSettings": "50th_Percentile",
                            "sizeAggregation": "Sum",
                            "legendMetric": "50th_Percentile",
                            "legendAggregation": "Sum",
                            "itemColorSettings": {
                              "type": "heatmap",
                              "colorAggregation": "Sum",
                              "nodeColorField": "50th_Percentile",
                              "heatmapPalette": "greenRed"
                            }
                          }
                        },
                        "name": "MTTC by Shift",
                        "styleSettings": {
                          "showBorder": true
                        }
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "group - 3"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let base = SecurityIncident\r\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\r\n| where Status == 'Closed'\r\n| summarize arg_min(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where not(Status == 'Closed' and isempty(Owner))\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize make_set(Tactics))\r\n| extend ttc = datetime_diff('second', ClosedTime, CreatedTime);\r\nunion (base | summarize ['Number of Incidents']=count(), MeanTTC=avg(ttc) | extend Owner = 'All'),\r\n(base | summarize ['Number of Incidents']=count(), MeanTTC=avg(ttc) by Owner)\r\n| extend ['Mean Time to Close'] = case(MeanTTC >= 60 and MeanTTC < 3600, strcat(toint(MeanTTC / 60), \r\n                                                                                iff(toint(MeanTTC / 60) > 1, ' minutes ', ' minute '),\r\n                                                                                '\\n',\r\n                                                                                toint(round(MeanTTC % 60, 0)), \r\n                                                                                iff(toint(round(MeanTTC % 60, 0)) > 1, ' seconds', ' second')),\r\n                                        MeanTTC > 3600, strcat(toint(MeanTTC / 3600), \r\n                                                            iff(toint(MeanTTC / 3600) > 1, ' hours ', ' hour '), \r\n                                                            toint((MeanTTC % 3600) / 60), \r\n                                                            iff(toint(MeanTTC / 3600) > 1, ' minutes ', ' minute ')),\r\n                                        strcat(toint(round(MeanTTC % 60, 0)), \r\n                                            iff(toint(round(MeanTTC % 60, 0)) > 1, ' seconds', ' second')))\r\n| project OwnerAndCount = strcat(Owner, ' - ', ['Number of Incidents']), Owner, ['Number of Incidents'], ['Mean Time to Close'], MeanTTC = MeanTTC / 60",
                    "size": 0,
                    "title": "Mean Time to Close by Owner",
                    "showRefreshButton": true,
                    "exportFieldName": "series",
                    "exportParameterName": "Status",
                    "exportDefaultValue": "All",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "OwnerAndCount",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "MeanTTC",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "auto"
                        },
                        "numberFormat": {
                          "unit": 25,
                          "options": {
                            "style": "decimal",
                            "useGrouping": false,
                            "maximumFractionDigits": 1
                          }
                        }
                      },
                      "secondaryContent": {
                        "columnMatch": "Mean Time to Close",
                        "formatter": 1
                      },
                      "showBorder": false
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 2 - Copy",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "name": "group - mttc"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\r\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\r\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where not(Status == 'Closed' and isempty(Owner))\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize make_set(Tactics))\r\n| where Status != 'Closed'\r\n| summarize Count=count() by Severity",
              "size": 0,
              "title": "Count of Incidents Under Investigation",
              "noDataMessage": "No incidents currently under investigation",
              "noDataMessageStyle": 3,
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "piechart",
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "Severity",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "dcount_IncidentNumber",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "query - 12",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\r\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\r\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where not(Status == 'Closed' and isempty(Owner))\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize Tactics=make_set(Tactics))\r\n| where Status != 'Closed'\r\n| project CreatedTime, IncidentNumber, Title, Severity, Status, Owner, ProviderName, Product, IncidentUrl",
              "size": 0,
              "title": "Incidents Under Investigation",
              "noDataMessage": "No incidents currently under investigation",
              "noDataMessageStyle": 3,
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Severity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Low",
                          "representation": "Sev3",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Medium",
                          "representation": "Sev2",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "High",
                          "representation": "Sev1",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Sev4",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "IncidentUrl",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "Url",
                      "linkLabel": "Go to incident >"
                    }
                  }
                ],
                "labelSettings": [
                  {
                    "columnId": "CreatedTime",
                    "label": "Created Time"
                  },
                  {
                    "columnId": "IncidentNumber",
                    "label": "Incident Number"
                  },
                  {
                    "columnId": "Title",
                    "label": "Title"
                  },
                  {
                    "columnId": "Severity",
                    "label": "Severity"
                  },
                  {
                    "columnId": "Status",
                    "label": "Status"
                  },
                  {
                    "columnId": "Owner",
                    "label": "Owner"
                  },
                  {
                    "columnId": "ProviderName",
                    "label": "Provider"
                  },
                  {
                    "columnId": "Product",
                    "label": "Product"
                  },
                  {
                    "columnId": "IncidentUrl",
                    "label": "Link to Incident"
                  }
                ]
              },
              "sortBy": []
            },
            "customWidth": "50",
            "name": "query - 14",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\r\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\r\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where not(Status == 'Closed' and isempty(Owner))\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize make_set(Tactics))\r\n| summarize Count=count() by Title\r\n| sort by Count desc\r\n",
              "size": 0,
              "title": "Incident Count by Title",
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Title",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "95%"
                    }
                  },
                  {
                    "columnMatch": "Count",
                    "formatter": 3,
                    "formatOptions": {
                      "palette": "purpleBlueGreen",
                      "customColumnWidthSetting": "5%"
                    }
                  }
                ]
              },
              "sortBy": []
            },
            "customWidth": "50",
            "name": "query - 9",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\r\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\r\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where not(Status == 'Closed' and isempty(Owner))\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize Tactics=make_set(Tactics))\r\n| where Severity == \"High\" and Status == \"Closed\"\r\n| project CreatedTime, IncidentNumber, Title, Severity, Owner, Status, ClosingClassification=strcat(Classification, ' - ', ClassificationReason), ClosingComment=ClassificationComment, ClosedTime, ProviderName, Product, IncidentUrl\r\n",
              "size": 0,
              "title": "High Severity Incidents",
              "noDataMessage": "No recent high severity incidents",
              "noDataMessageStyle": 3,
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Severity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Sev1",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "IncidentUrl",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "Url",
                      "linkLabel": "Go to incident >"
                    }
                  }
                ],
                "sortBy": [
                  {
                    "itemKey": "IncidentNumber",
                    "sortOrder": 1
                  }
                ],
                "labelSettings": [
                  {
                    "columnId": "CreatedTime",
                    "label": "Created Time"
                  },
                  {
                    "columnId": "IncidentNumber",
                    "label": "Incident Number"
                  },
                  {
                    "columnId": "Title",
                    "label": "Title"
                  },
                  {
                    "columnId": "Severity",
                    "label": "Severity"
                  },
                  {
                    "columnId": "Owner",
                    "label": "Owner"
                  },
                  {
                    "columnId": "Status",
                    "label": "Status"
                  },
                  {
                    "columnId": "ClosingClassification",
                    "label": "Closing Classification"
                  },
                  {
                    "columnId": "ClosingComment",
                    "label": "Closing Comment"
                  },
                  {
                    "columnId": "ClosedTime",
                    "label": "Closed Time"
                  },
                  {
                    "columnId": "ProviderName",
                    "label": "Provider"
                  },
                  {
                    "columnId": "Product",
                    "label": "Product"
                  },
                  {
                    "columnId": "IncidentUrl",
                    "label": "Link to Incident"
                  }
                ]
              },
              "sortBy": [
                {
                  "itemKey": "IncidentNumber",
                  "sortOrder": 1
                }
              ]
            },
            "customWidth": "50",
            "name": "query - 10",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\r\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\r\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where not(Status == 'Closed' and isempty(Owner))\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize Tactics=make_set(Tactics))\r\n| where Status == 'Closed' and Classification == \"TruePositive\"\r\n| project CreatedTime, IncidentNumber, Title, Severity, Owner, Status, ClosingClassification=strcat(Classification, ' - ', ClassificationReason), ClosingComment=ClassificationComment, ClosedTime, ProviderName, Product, IncidentUrl\r\n",
              "size": 0,
              "title": "True Positive Incidents",
              "noDataMessage": "No recent true positive incidents",
              "noDataMessageStyle": 3,
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Severity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Low",
                          "representation": "Sev3",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Medium",
                          "representation": "Sev2",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "High",
                          "representation": "Sev1",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Sev4",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "IncidentUrl",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "Url",
                      "linkLabel": "Go to incident >"
                    }
                  }
                ],
                "sortBy": [
                  {
                    "itemKey": "IncidentNumber",
                    "sortOrder": 1
                  }
                ],
                "labelSettings": [
                  {
                    "columnId": "CreatedTime",
                    "label": "Created Time"
                  },
                  {
                    "columnId": "IncidentNumber",
                    "label": "Incident Number"
                  },
                  {
                    "columnId": "Title",
                    "label": "Title"
                  },
                  {
                    "columnId": "Severity",
                    "label": "Severity"
                  },
                  {
                    "columnId": "Owner",
                    "label": "Owner"
                  },
                  {
                    "columnId": "Status",
                    "label": "Status"
                  },
                  {
                    "columnId": "ClosingClassification",
                    "label": "Closing Classification"
                  },
                  {
                    "columnId": "ClosingComment",
                    "label": "Closing Comment"
                  },
                  {
                    "columnId": "ClosedTime",
                    "label": "Closed Time"
                  },
                  {
                    "columnId": "ProviderName",
                    "label": "Provider"
                  },
                  {
                    "columnId": "Product",
                    "label": "Product"
                  },
                  {
                    "columnId": "IncidentUrl",
                    "label": "Link to Incident"
                  }
                ]
              },
              "sortBy": [
                {
                  "itemKey": "IncidentNumber",
                  "sortOrder": 1
                }
              ]
            },
            "customWidth": "50",
            "name": "query - 10 - Copy",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\r\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\r\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where not(Status == 'Closed' and isempty(Owner))\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize Tactics=make_set(Tactics))\r\n| where Status == 'Closed' and Classification == \"FalsePositive\"\r\n| project CreatedTime, IncidentNumber, Title, Severity, Owner, Status, ClosingClassification=strcat(Classification, ' - ', ClassificationReason), ClosingComment=ClassificationComment, ClosedTime, ProviderName, Product, IncidentUrl\r\n",
              "size": 0,
              "title": "False Positive Incidents",
              "noDataMessage": "No recent false positive incidents",
              "noDataMessageStyle": 3,
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Severity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Low",
                          "representation": "Sev3",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Medium",
                          "representation": "Sev2",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "High",
                          "representation": "Sev1",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Sev4",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "IncidentUrl",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "Url",
                      "linkLabel": "Go to incident >"
                    }
                  }
                ],
                "sortBy": [
                  {
                    "itemKey": "IncidentNumber",
                    "sortOrder": 1
                  }
                ],
                "labelSettings": [
                  {
                    "columnId": "CreatedTime",
                    "label": "Created Time"
                  },
                  {
                    "columnId": "IncidentNumber",
                    "label": "Incident Number"
                  },
                  {
                    "columnId": "Title",
                    "label": "Title"
                  },
                  {
                    "columnId": "Severity",
                    "label": "Severity"
                  },
                  {
                    "columnId": "Owner",
                    "label": "Owner"
                  },
                  {
                    "columnId": "Status",
                    "label": "Status"
                  },
                  {
                    "columnId": "ClosingClassification",
                    "label": "Closing Classification"
                  },
                  {
                    "columnId": "ClosingComment",
                    "label": "Closing Comment"
                  },
                  {
                    "columnId": "ClosedTime",
                    "label": "Closed Time"
                  },
                  {
                    "columnId": "ProviderName",
                    "label": "Provider"
                  },
                  {
                    "columnId": "Product",
                    "label": "Product"
                  },
                  {
                    "columnId": "IncidentUrl",
                    "label": "Link to Incident"
                  }
                ]
              },
              "sortBy": [
                {
                  "itemKey": "IncidentNumber",
                  "sortOrder": 1
                }
              ]
            },
            "customWidth": "50",
            "name": "query - 10 - Copy - Copy",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Owner = tostring(Owner.assignedTo)\n| where not(Status == 'Closed' and isempty(Owner))\n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\n| where Product in ({Product}) or \"*\" in ({Product})\n| extend Tactics = todynamic(AdditionalData.tactics)\n| mv-expand Tactics to typeof(string)\n| where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n| summarize Incidents=count() by Tactics",
              "size": 0,
              "title": "Incident Tactics",
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "table",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Incidents",
                    "formatter": 3,
                    "formatOptions": {
                      "palette": "amethyst"
                    }
                  }
                ]
              },
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "Tactics",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "Incidents",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              },
              "mapSettings": {
                "locInfo": "LatLong",
                "sizeSettings": "Incidents",
                "sizeAggregation": "Sum",
                "legendMetric": "Incidents",
                "legendAggregation": "Sum",
                "itemColorSettings": {
                  "type": "heatmap",
                  "colorAggregation": "Sum",
                  "nodeColorField": "Incidents",
                  "heatmapPalette": "greenRed"
                }
              }
            },
            "customWidth": "50",
            "name": "query - 2 - Copy - Copy - Copy - Copy - Copy",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Owner = tostring(Owner.assignedTo)\n| where not(Status == 'Closed' and isempty(Owner))\n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\n| where Product in ({Product}) or \"*\" in ({Product})\n| extend Tactics = todynamic(AdditionalData.tactics)\n| mv-expand Tactics to typeof(string)\n| where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n| summarize Incidents=count() by Tactics, bin(CreatedTime, {TimeRange:grain})",
              "size": 0,
              "title": "Incident Tactics Over Time",
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "unstackedbar",
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "Tactics",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "Incidents",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              },
              "mapSettings": {
                "locInfo": "LatLong",
                "sizeSettings": "Incidents",
                "sizeAggregation": "Sum",
                "legendMetric": "Incidents",
                "legendAggregation": "Sum",
                "itemColorSettings": {
                  "type": "heatmap",
                  "colorAggregation": "Sum",
                  "nodeColorField": "Incidents",
                  "heatmapPalette": "greenRed"
                }
              }
            },
            "customWidth": "50",
            "name": "query - 2 - Copy - Copy - Copy - Copy",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Owner = tostring(Owner.assignedTo)\n| where not(Status == 'Closed' and isempty(Owner))\n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\n| where Product in ({Product}) or \"*\" in ({Product})\n| extend Tactics = todynamic(AdditionalData.tactics)\n| mv-apply Tactics to typeof(string) on (\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n    | summarize Tactics=make_set(Tactics))\n| project LastModifiedTime, IncidentNumber, Title, Severity, Owner, Status, ProviderName, Product, IncidentUrl\n| top 50 by LastModifiedTime\n\n\n",
              "size": 0,
              "title": "Recent Incident Activity",
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "table",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Severity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Low",
                          "representation": "Sev3",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Medium",
                          "representation": "Sev2",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "High",
                          "representation": "Sev1",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Sev4",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "IncidentUrl",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "Url",
                      "linkLabel": "Go to incident >"
                    }
                  }
                ],
                "labelSettings": [
                  {
                    "columnId": "LastModifiedTime",
                    "label": "Last Modified Time"
                  },
                  {
                    "columnId": "IncidentNumber",
                    "label": "Incident Number"
                  },
                  {
                    "columnId": "Title",
                    "label": "Title"
                  },
                  {
                    "columnId": "Severity",
                    "label": "Severity"
                  },
                  {
                    "columnId": "Owner",
                    "label": "Owner"
                  },
                  {
                    "columnId": "Status",
                    "label": "Status"
                  },
                  {
                    "columnId": "ProviderName",
                    "label": "Provider"
                  },
                  {
                    "columnId": "Product",
                    "label": "Product"
                  },
                  {
                    "columnId": "IncidentUrl",
                    "label": "Link to Incident"
                  }
                ]
              },
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "Column1",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "IncidentNumber",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "name": "query - 2 - Copy - Copy - Copy - Copy",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Owner = tostring(Owner.assignedTo)\n| where not(Status == 'Closed' and isempty(Owner))\n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\n| where Product in ({Product}) or \"*\" in ({Product})\n| extend Tactics = todynamic(AdditionalData.tactics)\n| mv-apply Tactics to typeof(string) on (\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n    | summarize Tactics=make_set(Tactics))\n| where Status == 'Closed'\n| project ClosedTime, IncidentNumber, Title, Severity, Owner, ClosingClassification=strcat(Classification, ' - ', ClassificationReason), ClosingComment=ClassificationComment, ProviderName, Product, IncidentUrl\n| top 50 by ClosedTime\n\n\n\n",
              "size": 0,
              "title": "Recent Incident Closings",
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "table",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Severity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Low",
                          "representation": "Sev3",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Medium",
                          "representation": "Sev2",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "High",
                          "representation": "Sev1",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Sev4",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "IncidentUrl",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "Url",
                      "linkLabel": "Go to incident >"
                    }
                  }
                ],
                "labelSettings": [
                  {
                    "columnId": "ClosedTime",
                    "label": "Closed Time"
                  },
                  {
                    "columnId": "IncidentNumber",
                    "label": "Incident Number"
                  },
                  {
                    "columnId": "Title",
                    "label": "Title"
                  },
                  {
                    "columnId": "Severity",
                    "label": "Severity"
                  },
                  {
                    "columnId": "Owner",
                    "label": "Owner"
                  },
                  {
                    "columnId": "ClosingClassification",
                    "label": "Closing Classification"
                  },
                  {
                    "columnId": "ClosingComment",
                    "label": "Closing Comment"
                  },
                  {
                    "columnId": "ProviderName",
                    "label": "Provider"
                  },
                  {
                    "columnId": "Product",
                    "label": "Product"
                  },
                  {
                    "columnId": "IncidentUrl",
                    "label": "Link to incident"
                  }
                ]
              },
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "Column1",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "IncidentNumber",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "name": "query - 2 - Copy - Copy - Copy - Copy",
            "styleSettings": {
              "showBorder": true
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "Tab",
        "comparison": "isEqualTo",
        "value": "all"
      },
      "name": "group - 6",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "68bc16a9-34a8-4084-97a3-ea7e8e69c0e3",
            "version": "KqlParameterItem/1.0",
            "name": "isDlpSelected",
            "type": 1,
            "query": "let Product = print Product = dynamic([{Product}]);\r\nProduct\r\n| extend hasDlp = case(\r\n    Product has \"Microsoft Data Loss Prevention\" and array_length(Product) == 1, 1,\r\n    Product !has \"Microsoft Data Loss Prevention\" and Product != '[\"*\"]', -1, \r\n    0)\r\n| project hasDlp",
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange",
            "queryType": 0,
            "resourceType": "microsoft.operationalinsights/workspaces"
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "conditionalVisibility": {
        "parameterName": "x",
        "comparison": "isEqualTo",
        "value": "9999999"
      },
      "name": "parameters - 14"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "<h3>Viewing DLP incidents is not supported for this tab. Please use the DLP Incidents tab or change the Product filter to view other incidents.</h3>",
              "style": "error"
            },
            "name": "text - 13"
          },
          {
            "type": 11,
            "content": {
              "version": "LinkItem/1.0",
              "style": "nav",
              "links": [
                {
                  "id": "73d909cd-afef-4a33-a83a-88f50f37a3d3",
                  "cellValue": "Product",
                  "linkTarget": "parameter",
                  "linkLabel": "Reset",
                  "subTarget": "[\"*\"]",
                  "preText": "Product Filter",
                  "style": "primary"
                }
              ]
            },
            "name": "links - 11"
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "non-dlp"
        },
        {
          "parameterName": "isDlpSelected",
          "comparison": "isEqualTo",
          "value": "1"
        }
      ],
      "name": "DLP selected on Non-DLP tab error handling"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 1,
            "content": {
              "json": "<h3>Viewing non-DLP incidents is not supported for this tab. Please use the Non-DLP Incidents tab or change the Product filter to view other incidents.</h3>",
              "style": "error"
            },
            "name": "text - 13 - Copy"
          },
          {
            "type": 11,
            "content": {
              "version": "LinkItem/1.0",
              "style": "nav",
              "links": [
                {
                  "id": "bf7408b9-6f21-4d89-8a79-905ab04c0a6e",
                  "cellValue": "Product",
                  "linkTarget": "parameter",
                  "linkLabel": "Reset",
                  "subTarget": "[\"*\"]",
                  "preText": "Product Filter",
                  "style": "primary"
                }
              ]
            },
            "name": "links - 11 - Copy"
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "dlp"
        },
        {
          "parameterName": "isDlpSelected",
          "comparison": "isEqualTo",
          "value": "-1"
        }
      ],
      "name": "Non-DLP selected on DLP tab error handling"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "2fd54280-faf8-40de-8aa2-c7f40c842704",
                  "version": "KqlParameterItem/1.0",
                  "name": "PhishingTitles",
                  "label": "Phishing Incident Names",
                  "type": 9,
                  "isRequired": true,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "jsonData": "[\"CS-127 - Darktrace - Antigena Email threat alert\", \r\n\"Email messages containing malicious file\", \r\n\"Email reported by user as malware or phish\", \r\n\"High Confidence Phish\", \r\n\"Initial access incident\", \r\n\"Phishing\", \r\n\"Phish delivered due to an IP allow policy\", \r\n\"Phish\"]",
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "defaultValue": "value::all",
                  "value": [
                    "CS-127 - Darktrace - Antigena Email threat alert",
                    "Email messages containing malicious file",
                    "Email reported by user as malware or phish",
                    "High Confidence Phish",
                    "Initial access incident",
                    "Phishing",
                    "Phish delivered due to an IP allow policy",
                    "Phish"
                  ]
                }
              ],
              "style": "formVertical",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "conditionalVisibility": {
              "parameterName": "1",
              "comparison": "isEqualTo",
              "value": "2"
            },
            "name": "parameters - 13"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Owner = tostring(Owner.assignedTo)\n| where not(Status == 'Closed' and isempty(Owner))\n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\n| where Product in ({Product}) or \"*\" in ({Product})\n| where not(Title has_any ({PhishingTitles}))\n| where Product != 'Microsoft Data Loss Prevention' and not(Product == 'Microsoft 365 Defender' and Title startswith 'DLP')\n| extend Tactics = todynamic(AdditionalData.tactics)\n| mv-apply Tactics to typeof(string) on (\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n    | summarize make_set(Tactics))\n| summarize count() by bin(CreatedTime, max_of({TimeRange:grain}, 1h)), Severity",
              "size": 0,
              "title": "Incidents Created Over Time",
              "timeContextFromParameter": "TimeRange",
              "timeBrushParameterName": "TimeRange",
              "timeBrushExportOnlyWhenBrushed": true,
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "barchart",
              "gridSettings": {
                "sortBy": [
                  {
                    "itemKey": "IncidentNumber",
                    "sortOrder": 1
                  }
                ]
              },
              "sortBy": [
                {
                  "itemKey": "IncidentNumber",
                  "sortOrder": 1
                }
              ],
              "chartSettings": {
                "seriesLabelSettings": [
                  {
                    "seriesName": "count_",
                    "label": "Incidents"
                  }
                ],
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 17,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "Incidents over time ",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Owner = tostring(Owner.assignedTo)\n| where not(Status == 'Closed' and isempty(Owner))\n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\n| where Product in ({Product}) or \"*\" in ({Product})\n| where not(Title has_any ({PhishingTitles}))\n| where Product != 'Microsoft Data Loss Prevention' and not(Product == 'Microsoft 365 Defender' and Title startswith 'DLP')\n| extend Tactics = todynamic(AdditionalData.tactics)\n| mv-apply Tactics to typeof(string) on (\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n    | summarize make_set(Tactics))\n| where Status == 'Closed'\n| summarize count() by bin(ClosedTime, max_of({TimeRange:grain}, 1h)), Severity",
              "size": 0,
              "title": "Incidents Closed Over Time",
              "color": "green",
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "barchart",
              "gridSettings": {
                "sortBy": [
                  {
                    "itemKey": "CreatedTime",
                    "sortOrder": 2
                  }
                ]
              },
              "sortBy": [
                {
                  "itemKey": "CreatedTime",
                  "sortOrder": 2
                }
              ],
              "chartSettings": {
                "seriesLabelSettings": [
                  {
                    "seriesName": "count_",
                    "label": "Incidents"
                  },
                  {
                    "seriesName": "Low",
                    "color": "grayBlue"
                  },
                  {
                    "seriesName": "Medium",
                    "color": "amethyst"
                  },
                  {
                    "seriesName": "High",
                    "color": "gray"
                  }
                ]
              }
            },
            "customWidth": "50",
            "name": "Incidents over time  - Copy",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Owner = tostring(Owner.assignedTo)\n| where not(Status == 'Closed' and isempty(Owner))\n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\n| where Product in ({Product}) or \"*\" in ({Product})\n| where not(Title has_any ({PhishingTitles}))\n| where Product != 'Microsoft Data Loss Prevention' and not(Product == 'Microsoft 365 Defender' and Title startswith 'DLP')\n| extend Tactics = todynamic(AdditionalData.tactics)\n| mv-apply Tactics to typeof(string) on (\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n    | summarize make_set(Tactics))\n| where Status == 'Closed'\n| extend feedback = strcat(Classification,\": \",ClassificationReason)\n| extend feedback = case(feedback == 'TruePositive: SuspiciousActivity', 'True Positive: Suspicious activity',\n                         feedback == 'BenignPositive: SuspiciousButExpected', 'Benign Positive: Suspicious but expected',\n                         feedback == 'FalsePositive: IncorrectAlertLogic', 'False Positive: Incorrect alert logic',\n                         feedback == 'FalsePositive: InaccurateData', 'False Positive: Inaccurate data',\n                         'Undetermined')\n| summarize Count=count() by feedback\n| sort by Count desc\n",
              "size": 0,
              "title": "Incidents by Closing Classification",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "piechart",
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "feedback",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "Count",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "Incidents by classification - headline",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\r\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| where isempty(Owner) and Status == 'Closed'\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| where not(Title has_any ({PhishingTitles}))\r\n| where Product != 'Microsoft Data Loss Prevention' and not(Product == 'Microsoft 365 Defender' and Title startswith 'DLP')\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize Tactics=make_set(Tactics))\r\n| project CreatedTime, IncidentNumber, Title, Severity, ModifiedBy, Status, Classification, ClassificationComment, ProviderName, Product, Tactics\r\n//| summarize count() by bin(CreatedTime, {TimeRange:grain})",
              "size": 0,
              "title": "Incidents Closed by Automation",
              "noDataMessage": "No recent incidents closed by Automation",
              "noDataMessageStyle": 3,
              "timeContext": {
                "durationMs": 86400000
              },
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Severity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Low",
                          "representation": "Sev3",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Medium",
                          "representation": "Sev2",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "High",
                          "representation": "Sev1",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Sev4",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  }
                ]
              },
              "graphSettings": {
                "type": 0
              }
            },
            "customWidth": "50",
            "name": "query - 13",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let base = SecurityIncident\r\n| where TimeGenerated between ({TimeRange:start} .. {TimeRange:end}) and Status == \"New\"\r\n| summarize arg_min(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| where not(Title has_any ({PhishingTitles}))\r\n| where Product != 'Microsoft Data Loss Prevention' and not(Product == 'Microsoft 365 Defender' and Title startswith 'DLP')\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize make_set(Tactics))\r\n| project CreatedTime=TimeGenerated, IncidentNumber, Severity\r\n| join (SecurityIncident\r\n| where TimeGenerated between ({TimeRange:start} .. {TimeRange:end})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where isnotempty(Owner)\r\n| summarize arg_min(TimeGenerated, *) by IncidentNumber\r\n| project IncidentNumber, LastModifiedTime, Owner) on IncidentNumber\r\n| extend ttt = datetime_diff('second', LastModifiedTime, CreatedTime);\r\nunion (base | summarize ['Number of Incidents']=count(), MeanTTT=round(avg(ttt), 0) | extend Severity = 'All'),\r\n      (base | summarize ['Number of Incidents']=count(), MeanTTT=round(avg(ttt), 0) by Severity)\r\n| mv-apply ttt = split(split(MeanTTT * 1s, '.')[0], ':') on (\r\n    summarize ttt = make_list(toint(iff(ttt startswith \"0\", trim_start(\"0\", tostring(ttt)), ttt))))\r\n| extend ['Mean Time to Triage'] = strcat(iff(ttt[0] > 0, strcat(ttt[0], \" hours \"), \"\"), iff(ttt[1] > 0, strcat(ttt[1], \" minutes \"), \"\"), iff(ttt[2] > 0, strcat(ttt[2], \" seconds\"), \"\"))\r\n| extend tempSeverity = case (Severity == 'All', 0, Severity == 'High', 1, Severity == 'Medium', 2,  Severity == 'Low', 3, Severity == 'informational', 4, 5)\r\n| project SeverityAndCount = strcat(Severity, ' - ', ['Number of Incidents']), Severity, ['Number of Incidents'], ['Mean Time to Triage'], MeanTTT = MeanTTT / 60, tempSeverity",
                    "size": 0,
                    "title": "Mean Time to Triage",
                    "showRefreshButton": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "SeverityAndCount",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "MeanTTT",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "auto"
                        },
                        "numberFormat": {
                          "unit": 25,
                          "options": {
                            "style": "decimal",
                            "maximumFractionDigits": 1
                          }
                        }
                      },
                      "secondaryContent": {
                        "columnMatch": "Mean Time to Triage",
                        "formatter": 1
                      },
                      "showBorder": false,
                      "sortCriteriaField": "tempSeverity",
                      "sortOrderField": 1,
                      "size": "auto"
                    },
                    "graphSettings": {
                      "type": 0
                    },
                    "mapSettings": {
                      "locInfo": "LatLong",
                      "sizeSettings": "50th_Percentile",
                      "sizeAggregation": "Sum",
                      "legendMetric": "50th_Percentile",
                      "legendAggregation": "Sum",
                      "itemColorSettings": {
                        "type": "heatmap",
                        "colorAggregation": "Sum",
                        "nodeColorField": "50th_Percentile",
                        "heatmapPalette": "greenRed"
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "MTTT",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let base = SecurityIncident\r\n| where TimeGenerated between ({TimeRange:start} .. {TimeRange:end}) and Status == \"New\"\r\n| summarize arg_min(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| where not(Title has_any ({PhishingTitles}))\r\n| where Product != 'Microsoft Data Loss Prevention' and not(Product == 'Microsoft 365 Defender' and Title startswith 'DLP')\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize make_set(Tactics))\r\n| project CreatedTime=TimeGenerated, IncidentNumber, Severity\r\n| join (SecurityIncident\r\n| where TimeGenerated between ({TimeRange:start} .. {TimeRange:end})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where isnotempty(Owner)\r\n| summarize arg_min(TimeGenerated, *) by IncidentNumber\r\n| project IncidentNumber, LastModifiedTime, Owner) on IncidentNumber\r\n| extend ttt = datetime_diff('second', LastModifiedTime, CreatedTime);\r\nunion (base | summarize ['Number of Incidents']=count(), MeanTTT=round(avg(ttt), 0) | extend Owner = 'All'),\r\n      (base | summarize ['Number of Incidents']=count(), MeanTTT=round(avg(ttt), 0) by Owner | sort by Owner asc)\r\n| mv-apply ttt = split(split(MeanTTT * 1s, '.')[0], ':') on (\r\n    summarize ttt = make_list(toint(iff(ttt startswith \"0\", trim_start(\"0\", tostring(ttt)), ttt))))\r\n| extend ['Mean Time to Triage'] = strcat(iff(ttt[0] > 0, strcat(ttt[0], \" hours \"), \"\"), iff(ttt[1] > 0, strcat(ttt[1], \" minutes \"), \"\"), iff(ttt[2] > 0, strcat(ttt[2], \" seconds\"), \"\"))\r\n| project OwnerAndCount = strcat(Owner, ' - ', ['Number of Incidents']), Owner, ['Number of Incidents'], ['Mean Time to Triage'], MeanTTT = MeanTTT / 60",
                    "size": 0,
                    "title": "Mean Time to Triage by Owner",
                    "showRefreshButton": true,
                    "exportFieldName": "series",
                    "exportParameterName": "Status",
                    "exportDefaultValue": "All",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "OwnerAndCount",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "MeanTTT",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "auto"
                        },
                        "numberFormat": {
                          "unit": 25,
                          "options": {
                            "style": "decimal",
                            "useGrouping": false,
                            "maximumFractionDigits": 1
                          }
                        }
                      },
                      "secondaryContent": {
                        "columnMatch": "Mean Time to Triage"
                      },
                      "showBorder": false
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 2 - Copy",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "name": "group - 13"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "SLA Evaluation",
              "items": [
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": ""
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "<h3>The time to triage for each incident is evaluated against the Time to Triage SLA Chart below and then assigned a color value. These colors represent how close the time to triage was to meeting the SLA threshold.</h3>\r\n<h4>Green = within SLA\r\n</br>Amber = missed SLA by small margin\r\n</br>Red = missed SLA by large margin</h4>",
                          "style": "upsell"
                        },
                        "name": "sla_group_table_title",
                        "styleSettings": {
                          "margin": "10px"
                        }
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": ""
                        },
                        "customWidth": "8",
                        "name": "text - 3"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "<h4>Time to Triage SLA Chart</h4>\r\n<table>\r\n <thead>\r\n  <tr><th>Severity</th><th>Green</th><th>Amber</th><th>Red</th></tr>\r\n </thead>\r\n <tbody>\r\n <tr><td>High</td><td>< 15 minutes</td><td><= 20 minutes</td><td>> 20 minutes</td></tr>\r\n <tr><td>Medium</td><td>< 30 minutes</td><td><= 45 minutes</td><td>> 45 minutes</td></tr>\r\n <tr><td>Low</td><td>< 120 minutes</td><td><= 180 minutes</td><td>> 180 minutes</td></tr>\r\n <tr><td>Informational</td><td>< 120 minutes</td><td><= 180 minutes</td><td>> 180 minutes</td></tr>\r\n </tbody>\r\n</table>"
                        },
                        "customWidth": "85",
                        "name": "text - 0",
                        "styleSettings": {
                          "margin": "10px"
                        }
                      }
                    ]
                  },
                  "customWidth": "35",
                  "name": "group - 4",
                  "styleSettings": {
                    "margin": "10px"
                  }
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 3"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let base = SecurityIncident\r\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where isnotempty(Owner)\r\n| summarize arg_min(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| where not(Title has_any ({PhishingTitles}))\r\n| where Product != 'Microsoft Data Loss Prevention' and not(Product == 'Microsoft 365 Defender' and Title startswith 'DLP')\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize make_set(Tactics))\r\n| extend TimeToTriage = datetime_diff('second', LastModifiedTime, CreatedTime)\r\n| extend SLA = LookupSLA(Severity, TimeToTriage/60.0);\r\ndatatable ( Severity:string, SLA:string ) [ \r\n    \"High\", \"\",\r\n    \"High\", \"Green\",\r\n    \"High\", \"Amber\",\r\n    \"High\", \"Red\",\r\n    \"Medium\", \"\",\r\n    \"Medium\", \"Green\",\r\n    \"Medium\", \"Amber\",\r\n    \"Medium\", \"Red\",\r\n    \"Low\", \"\",\r\n    \"Low\", \"Green\",\r\n    \"Low\", \"Amber\",\r\n    \"Low\", \"Red\",\r\n    \"Informational\", \"\",\r\n    \"Informational\", \"Green\",\r\n    \"Informational\", \"Amber\",\r\n    \"Informational\", \"Red\"\r\n]\r\n| lookup kind=leftouter (base\r\n| project IncidentNumber, Severity, CreatedTime, FirstModifiedTime, LastModifiedTime, Owner, ModifiedBy, SLA\r\n| summarize Incidents = count() by Severity, SLA\r\n| lookup kind=leftouter (base\r\n| summarize Total = count() by Severity) on Severity\r\n| union (base\r\n| project IncidentNumber, Severity, CreatedTime, FirstModifiedTime, LastModifiedTime, Owner, ModifiedBy, SLA\r\n| summarize Incidents = count() by Severity)) on Severity, SLA\r\n| extend ExportColumn = strcat(Severity, '-', SLA)\r\n| extend Incidents = coalesce(Incidents, 0), Total = iff(isnotempty(SLA), coalesce(Total, 1), int(null))\r\n| extend Percent = Incidents / todouble(Total)\r\n| extend SevRank = case(Severity==\"High\", 1, Severity==\"Medium\", 2, Severity==\"Low\", 3, Severity==\"Informational\", 4, 5)\r\n| extend SlaRank = case(SLA==\"Green\", 1, SLA==\"Amber\", 2, SLA==\"Red\", 3, 0)\r\n| extend Severity = case(Severity==\"High\", strcat('ðŸŸ¥ ', Severity), Severity==\"Medium\", strcat('ðŸŸ§ ', Severity), Severity==\"Low\", strcat('ðŸŸ¨ ', Severity), Severity==\"Informational\", strcat('â¬œ ', Severity), Severity)\r\n| extend Incidents = iff(isempty(SLA), strcat(\"Total = \", tostring(Incidents)), tostring(Incidents))\r\n| sort by SevRank asc, SlaRank asc\r\n| extend Severity = coalesce(SLA, Severity)\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
                    "size": 3,
                    "title": "SLA by Severity",
                    "timeContextFromParameter": "TimeRange",
                    "exportFieldName": "ExportColumn",
                    "exportParameterName": "SelectedSLA",
                    "exportDefaultValue": "*",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Severity",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Green",
                                "representation": "dot-green",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Amber",
                                "representation": "dot-orange",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Red",
                                "representation": "dot-red",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "regex",
                                "thresholdValue": ".*",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{0}{1}"
                              }
                            ],
                            "customColumnWidthSetting": "20ch"
                          }
                        },
                        {
                          "columnMatch": "SLA",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "Incidents",
                          "formatter": 2,
                          "formatOptions": {
                            "customColumnWidthSetting": "15ch"
                          }
                        },
                        {
                          "columnMatch": "Total",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "ExportColumn",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "Percent",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "15ch"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "percent"
                            }
                          }
                        },
                        {
                          "columnMatch": "SevRank",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "SlaRank",
                          "formatter": 5
                        }
                      ],
                      "labelSettings": [
                        {
                          "columnId": "Severity",
                          "label": "Severity / SLA"
                        }
                      ]
                    }
                  },
                  "customWidth": "60",
                  "name": "sla_query",
                  "styleSettings": {
                    "margin": "10px",
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let Selected = '{SelectedSLA}';\r\nlet SelectedSeverity = tostring(coalesce(split(Selected, '-')[0], split(Selected, '-')[1]));\r\nlet SelectedSLA = iff(isnotempty(split(Selected, '-')[1]), tostring(split(Selected, '-')[1]), '*');\r\nlet base = SecurityIncident\r\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where isnotempty(Owner)\r\n| summarize arg_min(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| where not(Title has_any ({PhishingTitles}))\r\n| where Product != 'Microsoft Data Loss Prevention' and not(Product == 'Microsoft 365 Defender' and Title startswith 'DLP')\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize make_set(Tactics))\r\n| extend TimeToTriage = datetime_diff('second', LastModifiedTime, CreatedTime)\r\n| extend SLA = LookupSLA(Severity, TimeToTriage/60.0);\r\nbase\r\n| where Severity == SelectedSeverity and (SLA ==  SelectedSLA or SelectedSLA == '*')\r\n| project SLA, IncidentNumber, Severity, Title, Owner, CreatedTime, FirstModifiedTime=LastModifiedTime, TimeToTriage, IncidentUrl",
                    "size": 3,
                    "title": "SLA Incident Drilldown",
                    "noDataMessage": "No incidents for the selected severity / SLA",
                    "noDataMessageStyle": 3,
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "SLA",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Green",
                                "representation": "dot-green",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Amber",
                                "representation": "dot-orange",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Red",
                                "representation": "dot-red",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "dot-gray",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Severity",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "20ch"
                          }
                        },
                        {
                          "columnMatch": "Title",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "70ch"
                          }
                        },
                        {
                          "columnMatch": "TimeToTriage",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "20ch"
                          },
                          "numberFormat": {
                            "unit": 24,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "IncidentUrl",
                          "formatter": 7,
                          "formatOptions": {
                            "linkTarget": "Url",
                            "linkLabel": "Link",
                            "customColumnWidthSetting": "20ch"
                          }
                        }
                      ],
                      "sortBy": [
                        {
                          "itemKey": "$gen_number_TimeToTriage_7",
                          "sortOrder": 2
                        }
                      ]
                    },
                    "sortBy": [
                      {
                        "itemKey": "$gen_number_TimeToTriage_7",
                        "sortOrder": 2
                      }
                    ]
                  },
                  "name": "sla_drilldown",
                  "styleSettings": {
                    "margin": "10px",
                    "showBorder": true
                  }
                }
              ]
            },
            "name": "sla_group",
            "styleSettings": {
              "margin": "10px",
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let base = SecurityIncident\r\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\r\n| where Status == 'Closed'\r\n| summarize arg_min(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where not(Status == 'Closed' and isempty(Owner))\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| where not(Title has_any ({PhishingTitles}))\r\n| where Product != 'Microsoft Data Loss Prevention' and not(Product == 'Microsoft 365 Defender' and Title startswith 'DLP')\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize make_set(Tactics))\r\n| extend ttc = datetime_diff('second', ClosedTime, CreatedTime);\r\nunion (base | summarize ['Number of Incidents']=count(), MeanTTC=avg(ttc) | extend Severity = 'All'),\r\n(base | summarize ['Number of Incidents']=count(), MeanTTC=avg(ttc) by Severity)\r\n| extend Start = {TimeRange:start}, End = {TimeRange:end}\r\n| extend ['Mean Time to Close'] = case(MeanTTC >= 60 and MeanTTC < 3600, strcat(toint(MeanTTC / 60), \r\n                                                                                iff(toint(MeanTTC / 60) > 1, ' minutes ', ' minute '),\r\n                                                                                '\\n',\r\n                                                                                toint(round(MeanTTC % 60, 0)), \r\n                                                                                iff(toint(round(MeanTTC % 60, 0)) > 1, ' seconds', ' second')),\r\n                                        MeanTTC > 3600, strcat(toint(MeanTTC / 3600), \r\n                                                            iff(toint(MeanTTC / 3600) > 1, ' hours ', ' hour '), \r\n                                                            toint((MeanTTC % 3600) / 60), \r\n                                                            iff(toint(MeanTTC / 3600) > 1, ' minutes ', ' minute ')),\r\n                                        strcat(toint(round(MeanTTC % 60, 0)), \r\n                                            iff(toint(round(MeanTTC % 60, 0)) > 1, ' seconds', ' second')))\r\n| extend tempSeverity = case (Severity == 'All', 0, Severity == 'High', 1, Severity == 'Medium', 2,  Severity == 'Low', 3, Severity == 'informational', 4, 5)\r\n| project Start, End, SeverityAndCount = strcat(Severity, ' - ', ['Number of Incidents']), Severity, ['Number of Incidents'], ['Mean Time to Close'], MeanTTC = MeanTTC / 60, tempSeverity\r\n",
                    "size": 0,
                    "title": "Mean Time to Close",
                    "timeContextFromParameter": "TimeRange",
                    "showRefreshButton": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "SeverityAndCount",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "MeanTTC",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "auto"
                        },
                        "numberFormat": {
                          "unit": 25,
                          "options": {
                            "style": "decimal",
                            "maximumFractionDigits": 1
                          }
                        }
                      },
                      "secondaryContent": {
                        "columnMatch": "Mean Time to Close",
                        "formatter": 1
                      },
                      "showBorder": false,
                      "sortCriteriaField": "tempSeverity",
                      "sortOrderField": 1,
                      "size": "auto"
                    },
                    "graphSettings": {
                      "type": 0
                    },
                    "mapSettings": {
                      "locInfo": "LatLong",
                      "sizeSettings": "50th_Percentile",
                      "sizeAggregation": "Sum",
                      "legendMetric": "50th_Percentile",
                      "legendAggregation": "Sum",
                      "itemColorSettings": {
                        "type": "heatmap",
                        "colorAggregation": "Sum",
                        "nodeColorField": "50th_Percentile",
                        "heatmapPalette": "greenRed"
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "MTTC",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let base = SecurityIncident\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\n| where Status == 'Closed'\n| summarize arg_min(TimeGenerated, *) by IncidentNumber\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Owner = tostring(Owner.assignedTo)\n| where not(Status == 'Closed' and isempty(Owner))\n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\n| where Product in ({Product}) or \"*\" in ({Product})\n| where not(Title has_any ({PhishingTitles}))\n| where Product != 'Microsoft Data Loss Prevention' and not(Product == 'Microsoft 365 Defender' and Title startswith 'DLP')\n| extend Tactics = todynamic(AdditionalData.tactics)\n| mv-apply Tactics to typeof(string) on (\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n    | summarize make_set(Tactics))\n| extend ttc = datetime_diff('second', ClosedTime, CreatedTime);\nunion (base | summarize ['Number of Incidents']=count(), MeanTTC=avg(ttc) | extend Owner = 'All'),\n(base | summarize ['Number of Incidents']=count(), MeanTTC=avg(ttc) by Owner)\n| extend ['Mean Time to Close'] = case(MeanTTC >= 60 and MeanTTC < 3600, strcat(toint(MeanTTC / 60), \n                                                                                iff(toint(MeanTTC / 60) > 1, ' minutes ', ' minute '),\n                                                                                '\\n',\n                                                                                toint(round(MeanTTC % 60, 0)), \n                                                                                iff(toint(round(MeanTTC % 60, 0)) > 1, ' seconds', ' second')),\n                                        MeanTTC > 3600, strcat(toint(MeanTTC / 3600), \n                                                            iff(toint(MeanTTC / 3600) > 1, ' hours ', ' hour '), \n                                                            toint((MeanTTC % 3600) / 60), \n                                                            iff(toint(MeanTTC / 3600) > 1, ' minutes ', ' minute ')),\n                                        strcat(toint(round(MeanTTC % 60, 0)), \n                                            iff(toint(round(MeanTTC % 60, 0)) > 1, ' seconds', ' second')))\n| project OwnerAndCount = strcat(Owner, ' - ', ['Number of Incidents']), Owner, ['Number of Incidents'], ['Mean Time to Close'], MeanTTC = MeanTTC / 60\n\n",
                    "size": 0,
                    "title": "Mean Time to Close by Owner",
                    "timeContextFromParameter": "TimeRange",
                    "showRefreshButton": true,
                    "exportFieldName": "series",
                    "exportParameterName": "Status",
                    "exportDefaultValue": "All",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "OwnerAndCount",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "MeanTTC",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "auto"
                        },
                        "numberFormat": {
                          "unit": 25,
                          "options": {
                            "style": "decimal",
                            "useGrouping": false,
                            "maximumFractionDigits": 1
                          }
                        }
                      },
                      "secondaryContent": {
                        "columnMatch": "Mean Time to Close",
                        "formatter": 1
                      },
                      "showBorder": false
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 2 - Copy",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "name": "group - mttc"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\r\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\r\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where not(Status == 'Closed' and isempty(Owner))\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| where not(Title has_any ({PhishingTitles}))\r\n| where Product != 'Microsoft Data Loss Prevention' and not(Product == 'Microsoft 365 Defender' and Title startswith 'DLP')\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize make_set(Tactics))\r\n| where Status != 'Closed'\r\n| summarize Count=count() by Severity",
              "size": 0,
              "title": "Count of Incidents Under Investigation",
              "noDataMessage": "No incidents currently under investigation",
              "noDataMessageStyle": 3,
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "piechart",
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "Severity",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "dcount_IncidentNumber",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "query - 12",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\r\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\r\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where not(Status == 'Closed' and isempty(Owner))\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| where not(Title has_any ({PhishingTitles}))\r\n| where Product != 'Microsoft Data Loss Prevention' and not(Product == 'Microsoft 365 Defender' and Title startswith 'DLP')\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize Tactics=make_set(Tactics))\r\n| where Status != 'Closed'\r\n| project CreatedTime, IncidentNumber, Title, Severity, Status, Owner, ProviderName, Product, IncidentUrl",
              "size": 0,
              "title": "Incidents Under Investigation",
              "noDataMessage": "No incidents currently under investigation",
              "noDataMessageStyle": 3,
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Severity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Low",
                          "representation": "Sev3",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Medium",
                          "representation": "Sev2",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "High",
                          "representation": "Sev1",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Sev4",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "IncidentUrl",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "Url",
                      "linkLabel": "Go to incident >"
                    }
                  }
                ],
                "labelSettings": [
                  {
                    "columnId": "CreatedTime",
                    "label": "Created Time"
                  },
                  {
                    "columnId": "IncidentNumber",
                    "label": "Incident Number"
                  },
                  {
                    "columnId": "Title",
                    "label": "Title"
                  },
                  {
                    "columnId": "Severity",
                    "label": "Severity"
                  },
                  {
                    "columnId": "Status",
                    "label": "Status"
                  },
                  {
                    "columnId": "Owner",
                    "label": "Owner"
                  },
                  {
                    "columnId": "ProviderName",
                    "label": "Provider"
                  },
                  {
                    "columnId": "Product",
                    "label": "Product"
                  },
                  {
                    "columnId": "IncidentUrl",
                    "label": "Link to Incident"
                  }
                ]
              },
              "sortBy": []
            },
            "customWidth": "50",
            "name": "query - 14",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\r\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\r\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where not(Status == 'Closed' and isempty(Owner))\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| where not(Title has_any ({PhishingTitles}))\r\n| where Product != 'Microsoft Data Loss Prevention' and not(Product == 'Microsoft 365 Defender' and Title startswith 'DLP')\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize Tactics=make_set(Tactics))\r\n| where Severity == \"High\" and Status == \"Closed\"\r\n| project CreatedTime, IncidentNumber, Title, Severity, Owner, Status, ClosingClassification=strcat(Classification, ' - ', ClassificationReason), ClosingComment=ClassificationComment, ClosedTime, ProviderName, Product, IncidentUrl\r\n",
              "size": 0,
              "title": "High Severity Incidents",
              "noDataMessage": "No recent high severity incidents",
              "noDataMessageStyle": 3,
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Severity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Sev1",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "IncidentUrl",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "Url",
                      "linkLabel": "Go to incident >"
                    }
                  }
                ],
                "sortBy": [
                  {
                    "itemKey": "IncidentNumber",
                    "sortOrder": 1
                  }
                ],
                "labelSettings": [
                  {
                    "columnId": "CreatedTime",
                    "label": "Created Time"
                  },
                  {
                    "columnId": "IncidentNumber",
                    "label": "Incident Number"
                  },
                  {
                    "columnId": "Title",
                    "label": "Title"
                  },
                  {
                    "columnId": "Severity",
                    "label": "Severity"
                  },
                  {
                    "columnId": "Owner",
                    "label": "Owner"
                  },
                  {
                    "columnId": "Status",
                    "label": "Status"
                  },
                  {
                    "columnId": "ClosingClassification",
                    "label": "Closing Classification"
                  },
                  {
                    "columnId": "ClosingComment",
                    "label": "Closing Comment"
                  },
                  {
                    "columnId": "ClosedTime",
                    "label": "Closed Time"
                  },
                  {
                    "columnId": "ProviderName",
                    "label": "Provider"
                  },
                  {
                    "columnId": "Product",
                    "label": "Product"
                  },
                  {
                    "columnId": "IncidentUrl",
                    "label": "Link to Incident"
                  }
                ]
              },
              "sortBy": [
                {
                  "itemKey": "IncidentNumber",
                  "sortOrder": 1
                }
              ]
            },
            "customWidth": "50",
            "name": "query - 10",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\r\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\r\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where not(Status == 'Closed' and isempty(Owner))\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| where not(Title has_any ({PhishingTitles}))\r\n| where Product != 'Microsoft Data Loss Prevention' and not(Product == 'Microsoft 365 Defender' and Title startswith 'DLP')\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize Tactics=make_set(Tactics))\r\n| where Status == 'Closed' and Classification == \"TruePositive\"\r\n| project CreatedTime, IncidentNumber, Title, Severity, Owner, Status, ClosingClassification=strcat(Classification, ' - ', ClassificationReason), ClosingComment=ClassificationComment, ClosedTime, ProviderName, Product, IncidentUrl\r\n",
              "size": 0,
              "title": "True Positive Incidents",
              "noDataMessage": "No recent true positive incidents",
              "noDataMessageStyle": 3,
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Severity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Low",
                          "representation": "Sev3",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Medium",
                          "representation": "Sev2",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "High",
                          "representation": "Sev1",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Sev4",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "IncidentUrl",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "Url",
                      "linkLabel": "Go to incident >"
                    }
                  }
                ],
                "sortBy": [
                  {
                    "itemKey": "IncidentNumber",
                    "sortOrder": 1
                  }
                ],
                "labelSettings": [
                  {
                    "columnId": "CreatedTime",
                    "label": "Created Time"
                  },
                  {
                    "columnId": "IncidentNumber",
                    "label": "Incident Number"
                  },
                  {
                    "columnId": "Title",
                    "label": "Title"
                  },
                  {
                    "columnId": "Severity",
                    "label": "Severity"
                  },
                  {
                    "columnId": "Owner",
                    "label": "Owner"
                  },
                  {
                    "columnId": "Status",
                    "label": "Status"
                  },
                  {
                    "columnId": "ClosingClassification",
                    "label": "Closing Classification"
                  },
                  {
                    "columnId": "ClosingComment",
                    "label": "Closing Comment"
                  },
                  {
                    "columnId": "ClosedTime",
                    "label": "Closed Time"
                  },
                  {
                    "columnId": "ProviderName",
                    "label": "Provider"
                  },
                  {
                    "columnId": "Product",
                    "label": "Product"
                  },
                  {
                    "columnId": "IncidentUrl",
                    "label": "Link to Incident"
                  }
                ]
              },
              "sortBy": [
                {
                  "itemKey": "IncidentNumber",
                  "sortOrder": 1
                }
              ]
            },
            "customWidth": "50",
            "name": "query - 10 - Copy",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Owner = tostring(Owner.assignedTo)\n| where not(Status == 'Closed' and isempty(Owner))\n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\n| where Product in ({Product}) or \"*\" in ({Product})\n| where not(Title has_any ({PhishingTitles}))\n| where Product != 'Microsoft Data Loss Prevention' and not(Product == 'Microsoft 365 Defender' and Title startswith 'DLP')\n| extend Tactics = todynamic(AdditionalData.tactics)\n| mv-expand Tactics to typeof(string)\n| where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n| summarize Incidents=count() by Tactics, bin(CreatedTime, {TimeRange:grain})",
              "size": 0,
              "title": "Incident Tactics Over Time",
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "unstackedbar"
            },
            "customWidth": "50",
            "name": "query - 2 - Copy - Copy - Copy - Copy",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\r\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\r\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where not(Status == 'Closed' and isempty(Owner))\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| where not(Title has_any ({PhishingTitles}))\r\n| where Product != 'Microsoft Data Loss Prevention' and not(Product == 'Microsoft 365 Defender' and Title startswith 'DLP')\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize make_set(Tactics))\r\n| summarize Count=count() by Title\r\n| sort by Count desc\r\n",
              "size": 0,
              "title": "Incident Count by Title",
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Title",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "95%"
                    }
                  },
                  {
                    "columnMatch": "Count",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "purpleBlueGreen",
                      "customColumnWidthSetting": "5%"
                    }
                  }
                ]
              },
              "sortBy": []
            },
            "customWidth": "50",
            "name": "query - 9",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Owner = tostring(Owner.assignedTo)\n| where not(Status == 'Closed' and isempty(Owner))\n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\n| where Product in ({Product}) or \"*\" in ({Product})\n| where not(Title has_any ({PhishingTitles}))\n| where Product != 'Microsoft Data Loss Prevention' and not(Product == 'Microsoft 365 Defender' and Title startswith 'DLP')\n| extend Tactics = todynamic(AdditionalData.tactics)\n| mv-apply Tactics to typeof(string) on (\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n    | summarize Tactics=make_set(Tactics))\n| project LastModifiedTime, IncidentNumber, Title, Severity, Owner, Status, ProviderName, Product, IncidentUrl\n| top 50 by LastModifiedTime\n\n\n",
              "size": 0,
              "title": "Recent Incident Activity",
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "table",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Severity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Low",
                          "representation": "Sev3",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Medium",
                          "representation": "Sev2",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "High",
                          "representation": "Sev1",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Sev4",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "IncidentUrl",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "Url",
                      "linkLabel": "Go to incident >"
                    }
                  }
                ],
                "labelSettings": [
                  {
                    "columnId": "LastModifiedTime",
                    "label": "Last Modified Time"
                  },
                  {
                    "columnId": "IncidentNumber",
                    "label": "Incident Number"
                  },
                  {
                    "columnId": "Title",
                    "label": "Title"
                  },
                  {
                    "columnId": "Severity",
                    "label": "Severity"
                  },
                  {
                    "columnId": "Owner",
                    "label": "Owner"
                  },
                  {
                    "columnId": "Status",
                    "label": "Status"
                  },
                  {
                    "columnId": "ProviderName",
                    "label": "Provider"
                  },
                  {
                    "columnId": "Product",
                    "label": "Product"
                  },
                  {
                    "columnId": "IncidentUrl",
                    "label": "Link to Incident"
                  }
                ]
              },
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "Column1",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "IncidentNumber",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "name": "query - 2 - Copy - Copy - Copy - Copy",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Owner = tostring(Owner.assignedTo)\n| where not(Status == 'Closed' and isempty(Owner))\n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\n| where Product in ({Product}) or \"*\" in ({Product})\n| where not(Title has_any ({PhishingTitles}))\n| where Product != 'Microsoft Data Loss Prevention' and not(Product == 'Microsoft 365 Defender' and Title startswith 'DLP')\n| extend Tactics = todynamic(AdditionalData.tactics)\n| mv-apply Tactics to typeof(string) on (\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n    | summarize Tactics=make_set(Tactics))\n| where Status == 'Closed'\n| project ClosedTime, IncidentNumber, Title, Severity, Owner, ClosingClassification=strcat(Classification, ' - ', ClassificationReason), ClosingComment=ClassificationComment, ProviderName, Product, IncidentUrl\n| top 50 by ClosedTime\n\n\n\n",
              "size": 0,
              "title": "Recent Incident Closings",
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "table",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Severity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Low",
                          "representation": "Sev3",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Medium",
                          "representation": "Sev2",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "High",
                          "representation": "Sev1",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Sev4",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "IncidentUrl",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "Url",
                      "linkLabel": "Go to incident >"
                    }
                  }
                ],
                "labelSettings": [
                  {
                    "columnId": "ClosedTime",
                    "label": "Closed Time"
                  },
                  {
                    "columnId": "IncidentNumber",
                    "label": "Incident Number"
                  },
                  {
                    "columnId": "Title",
                    "label": "Title"
                  },
                  {
                    "columnId": "Severity",
                    "label": "Severity"
                  },
                  {
                    "columnId": "Owner",
                    "label": "Owner"
                  },
                  {
                    "columnId": "ClosingClassification",
                    "label": "Closing Classification"
                  },
                  {
                    "columnId": "ClosingComment",
                    "label": "Closing Comment"
                  },
                  {
                    "columnId": "ProviderName",
                    "label": "Provider"
                  },
                  {
                    "columnId": "Product",
                    "label": "Product"
                  },
                  {
                    "columnId": "IncidentUrl",
                    "label": "Link to incident"
                  }
                ]
              },
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "Column1",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "IncidentNumber",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "name": "query - 2 - Copy - Copy - Copy - Copy",
            "styleSettings": {
              "showBorder": true
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "non-dlp"
        },
        {
          "parameterName": "isDlpSelected",
          "comparison": "isNotEqualTo",
          "value": "1"
        }
      ],
      "name": "group - 6 - Copy",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Owner = tostring(Owner.assignedTo)\n| where not(Status == 'Closed' and isempty(Owner))\n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\n| where Product in ({Product}) or \"*\" in ({Product})\n| where Product == 'Microsoft Data Loss Prevention' or (Product == 'Microsoft 365 Defender' and Title startswith 'DLP')\n| extend Tactics = todynamic(AdditionalData.tactics)\n| mv-apply Tactics to typeof(string) on (\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n    | summarize make_set(Tactics))\n| summarize count() by bin(CreatedTime, max_of({TimeRange:grain}, 1h)), Severity",
              "size": 0,
              "title": "Incidents Created Over Time",
              "timeContextFromParameter": "TimeRange",
              "timeBrushParameterName": "TimeRange",
              "timeBrushExportOnlyWhenBrushed": true,
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "barchart",
              "gridSettings": {
                "sortBy": [
                  {
                    "itemKey": "CreatedTime",
                    "sortOrder": 2
                  }
                ]
              },
              "sortBy": [
                {
                  "itemKey": "CreatedTime",
                  "sortOrder": 2
                }
              ],
              "chartSettings": {
                "seriesLabelSettings": [
                  {
                    "seriesName": "count_",
                    "label": "Incidents"
                  }
                ],
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 17,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "Incidents over time ",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\n| where Status == 'Closed'\n| summarize arg_min(TimeGenerated, *) by IncidentNumber\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Owner = tostring(Owner.assignedTo)\n| where not(Status == 'Closed' and isempty(Owner))\n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\n| where Product in ({Product}) or \"*\" in ({Product})\n| where Product == 'Microsoft Data Loss Prevention' or (Product == 'Microsoft 365 Defender' and Title startswith 'DLP')\n| extend Tactics = todynamic(AdditionalData.tactics)\n| mv-apply Tactics to typeof(string) on (\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n    | summarize make_set(Tactics))\n| summarize count() by bin(ClosedTime, max_of({TimeRange:grain}, 1h)), Severity",
              "size": 0,
              "title": "Incidents Closed Over Time",
              "color": "green",
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "barchart",
              "gridSettings": {
                "sortBy": [
                  {
                    "itemKey": "CreatedTime",
                    "sortOrder": 2
                  }
                ]
              },
              "sortBy": [
                {
                  "itemKey": "CreatedTime",
                  "sortOrder": 2
                }
              ],
              "chartSettings": {
                "seriesLabelSettings": [
                  {
                    "seriesName": "count_",
                    "label": "Incidents"
                  },
                  {
                    "seriesName": "Low",
                    "color": "grayBlue"
                  },
                  {
                    "seriesName": "Medium",
                    "color": "amethyst"
                  },
                  {
                    "seriesName": "High",
                    "color": "gray"
                  }
                ]
              }
            },
            "customWidth": "50",
            "name": "Incidents over time  - Copy",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Owner = tostring(Owner.assignedTo)\n| where not(Status == 'Closed' and isempty(Owner))\n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\n| where Product in ({Product}) or \"*\" in ({Product})\n| where Product == 'Microsoft Data Loss Prevention' or (Product == 'Microsoft 365 Defender' and Title startswith 'DLP')\n| extend Tactics = todynamic(AdditionalData.tactics)\n| mv-apply Tactics to typeof(string) on (\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n    | summarize make_set(Tactics))\n| where Status == 'Closed'\n| extend feedback = strcat(Classification,\": \",ClassificationReason)\n| extend feedback = case(feedback == 'TruePositive: SuspiciousActivity', 'True Positive: Suspicious activity',\n                         feedback == 'BenignPositive: SuspiciousButExpected', 'Benign Positive: Suspicious but expected',\n                         feedback == 'FalsePositive: IncorrectAlertLogic', 'False Positive: Incorrect alert logic',\n                         feedback == 'FalsePositive: InaccurateData', 'False Positive: Inaccurate data',\n                         'Undetermined')\n| summarize Count=count() by feedback\n| sort by Count desc\n",
              "size": 0,
              "title": "Incidents by Closing Classification",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "piechart",
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "feedback",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "Count",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "Incidents by classification - headline",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\r\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| where isempty(Owner) and Status == 'Closed'\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| where Product == 'Microsoft Data Loss Prevention' or (Product == 'Microsoft 365 Defender' and Title startswith 'DLP')\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize Tactics=make_set(Tactics))\r\n| project CreatedTime, IncidentNumber, Title, Severity, ModifiedBy, Status, Classification, ClassificationComment, ProviderName, Product, Tactics\r\n//| summarize count() by bin(CreatedTime, {TimeRange:grain})",
              "size": 0,
              "title": "Incidents Closed by Automation",
              "noDataMessage": "No recent incidents closed by Automation",
              "noDataMessageStyle": 3,
              "timeContext": {
                "durationMs": 86400000
              },
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Severity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Low",
                          "representation": "Sev3",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Medium",
                          "representation": "Sev2",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "High",
                          "representation": "Sev1",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Sev4",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  }
                ]
              },
              "graphSettings": {
                "type": 0
              }
            },
            "customWidth": "50",
            "name": "query - 13",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let base = SecurityIncident\r\n| where TimeGenerated between ({TimeRange:start} .. {TimeRange:end}) and Status == \"New\"\r\n| summarize arg_min(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| where Product == 'Microsoft Data Loss Prevention' or (Product == 'Microsoft 365 Defender' and Title startswith 'DLP')\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize make_set(Tactics))\r\n| project CreatedTime=TimeGenerated, IncidentNumber, Severity\r\n| join (SecurityIncident\r\n| where TimeGenerated between ({TimeRange:start} .. {TimeRange:end})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where isnotempty(Owner)\r\n| summarize arg_min(TimeGenerated, *) by IncidentNumber\r\n| project IncidentNumber, LastModifiedTime, Owner) on IncidentNumber\r\n| extend ttt = datetime_diff('second', LastModifiedTime, CreatedTime);\r\nunion (base | summarize ['Number of Incidents']=count(), MeanTTT=round(avg(ttt), 0) | extend Severity = 'All'),\r\n      (base | summarize ['Number of Incidents']=count(), MeanTTT=round(avg(ttt), 0) by Severity)\r\n| mv-apply ttt = split(split(MeanTTT * 1s, '.')[0], ':') on (\r\n    summarize ttt = make_list(toint(iff(ttt startswith \"0\", trim_start(\"0\", tostring(ttt)), ttt))))\r\n| extend ['Mean Time to Triage'] = strcat(iff(ttt[0] > 0, strcat(ttt[0], \" hours \"), \"\"), iff(ttt[1] > 0, strcat(ttt[1], \" minutes \"), \"\"), iff(ttt[2] > 0, strcat(ttt[2], \" seconds\"), \"\"))\r\n| extend tempSeverity = case (Severity == 'All', 0, Severity == 'High', 1, Severity == 'Medium', 2,  Severity == 'Low', 3, Severity == 'informational', 4, 5)\r\n| project SeverityAndCount = strcat(Severity, ' - ', ['Number of Incidents']), Severity, ['Number of Incidents'], ['Mean Time to Triage'], MeanTTT = MeanTTT / 60, tempSeverity",
                    "size": 0,
                    "title": "Mean Time to Triage",
                    "showRefreshButton": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "SeverityAndCount",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "MeanTTT",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "auto"
                        },
                        "numberFormat": {
                          "unit": 25,
                          "options": {
                            "style": "decimal",
                            "maximumFractionDigits": 1
                          }
                        }
                      },
                      "secondaryContent": {
                        "columnMatch": "Mean Time to Triage",
                        "formatter": 1
                      },
                      "showBorder": false,
                      "sortCriteriaField": "tempSeverity",
                      "sortOrderField": 1,
                      "size": "auto"
                    },
                    "graphSettings": {
                      "type": 0
                    },
                    "mapSettings": {
                      "locInfo": "LatLong",
                      "sizeSettings": "50th_Percentile",
                      "sizeAggregation": "Sum",
                      "legendMetric": "50th_Percentile",
                      "legendAggregation": "Sum",
                      "itemColorSettings": {
                        "type": "heatmap",
                        "colorAggregation": "Sum",
                        "nodeColorField": "50th_Percentile",
                        "heatmapPalette": "greenRed"
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "MTTT",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let base = SecurityIncident\r\n| where TimeGenerated between ({TimeRange:start} .. {TimeRange:end}) and Status == \"New\"\r\n| summarize arg_min(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| where Product == 'Microsoft Data Loss Prevention' or (Product == 'Microsoft 365 Defender' and Title startswith 'DLP')\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize make_set(Tactics))\r\n| project CreatedTime=TimeGenerated, IncidentNumber, Severity\r\n| join (SecurityIncident\r\n| where TimeGenerated between ({TimeRange:start} .. {TimeRange:end})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where isnotempty(Owner)\r\n| summarize arg_min(TimeGenerated, *) by IncidentNumber\r\n| project IncidentNumber, LastModifiedTime, Owner) on IncidentNumber\r\n| extend ttt = datetime_diff('second', LastModifiedTime, CreatedTime);\r\nunion (base | summarize ['Number of Incidents']=count(), MeanTTT=round(avg(ttt), 0) | extend Owner = 'All'),\r\n      (base | summarize ['Number of Incidents']=count(), MeanTTT=round(avg(ttt), 0) by Owner | sort by Owner asc)\r\n| mv-apply ttt = split(split(MeanTTT * 1s, '.')[0], ':') on (\r\n    summarize ttt = make_list(toint(iff(ttt startswith \"0\", trim_start(\"0\", tostring(ttt)), ttt))))\r\n| extend ['Mean Time to Triage'] = strcat(iff(ttt[0] > 0, strcat(ttt[0], \" hours \"), \"\"), iff(ttt[1] > 0, strcat(ttt[1], \" minutes \"), \"\"), iff(ttt[2] > 0, strcat(ttt[2], \" seconds\"), \"\"))\r\n| project OwnerAndCount = strcat(Owner, ' - ', ['Number of Incidents']), Owner, ['Number of Incidents'], ['Mean Time to Triage'], MeanTTT = MeanTTT / 60",
                    "size": 0,
                    "title": "Mean Time to Triage by Owner",
                    "showRefreshButton": true,
                    "exportFieldName": "series",
                    "exportParameterName": "Status",
                    "exportDefaultValue": "All",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "OwnerAndCount",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "MeanTTT",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "auto"
                        },
                        "numberFormat": {
                          "unit": 25,
                          "options": {
                            "style": "decimal",
                            "useGrouping": false,
                            "maximumFractionDigits": 1
                          }
                        }
                      },
                      "secondaryContent": {
                        "columnMatch": "Mean Time to Triage"
                      },
                      "showBorder": false
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 2 - Copy",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "name": "group - 13"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "SLA Evaluation",
              "items": [
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": ""
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "<h3>The time to triage for each incident is evaluated against the Time to Triage SLA Chart below and then assigned a color value. These colors represent how close the time to triage was to meeting the SLA threshold.</h3>\r\n<h4>Green = within SLA\r\n</br>Amber = missed SLA by small margin\r\n</br>Red = missed SLA by large margin</h4>",
                          "style": "upsell"
                        },
                        "name": "sla_group_table_title",
                        "styleSettings": {
                          "margin": "10px"
                        }
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": ""
                        },
                        "customWidth": "8",
                        "name": "text - 3"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "<h4>Time to Triage SLA Chart</h4>\r\n<table>\r\n <thead>\r\n  <tr><th>Severity</th><th>Green</th><th>Amber</th><th>Red</th></tr>\r\n </thead>\r\n <tbody>\r\n <tr><td>High</td><td>< 15 minutes</td><td><= 20 minutes</td><td>> 20 minutes</td></tr>\r\n <tr><td>Medium</td><td>< 30 minutes</td><td><= 45 minutes</td><td>> 45 minutes</td></tr>\r\n <tr><td>Low</td><td>< 120 minutes</td><td><= 180 minutes</td><td>> 180 minutes</td></tr>\r\n <tr><td>Informational</td><td>< 120 minutes</td><td><= 180 minutes</td><td>> 180 minutes</td></tr>\r\n </tbody>\r\n</table>"
                        },
                        "customWidth": "85",
                        "name": "text - 0",
                        "styleSettings": {
                          "margin": "10px"
                        }
                      }
                    ]
                  },
                  "customWidth": "35",
                  "name": "group - 4",
                  "styleSettings": {
                    "margin": "10px"
                  }
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 3"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let base = SecurityIncident\r\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where isnotempty(Owner)\r\n| summarize arg_min(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| where Product == 'Microsoft Data Loss Prevention' or (Product == 'Microsoft 365 Defender' and Title startswith 'DLP')\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize make_set(Tactics))\r\n| extend TimeToTriage = datetime_diff('second', LastModifiedTime, CreatedTime)\r\n| extend SLA = LookupSLA(Severity, TimeToTriage/60.0);\r\ndatatable ( Severity:string, SLA:string ) [ \r\n    \"High\", \"\",\r\n    \"High\", \"Green\",\r\n    \"High\", \"Amber\",\r\n    \"High\", \"Red\",\r\n    \"Medium\", \"\",\r\n    \"Medium\", \"Green\",\r\n    \"Medium\", \"Amber\",\r\n    \"Medium\", \"Red\",\r\n    \"Low\", \"\",\r\n    \"Low\", \"Green\",\r\n    \"Low\", \"Amber\",\r\n    \"Low\", \"Red\",\r\n    \"Informational\", \"\",\r\n    \"Informational\", \"Green\",\r\n    \"Informational\", \"Amber\",\r\n    \"Informational\", \"Red\"\r\n]\r\n| lookup kind=leftouter (base\r\n| project IncidentNumber, Severity, CreatedTime, FirstModifiedTime, LastModifiedTime, Owner, ModifiedBy, SLA\r\n| summarize Incidents = count() by Severity, SLA\r\n| lookup kind=leftouter (base\r\n| summarize Total = count() by Severity) on Severity\r\n| union (base\r\n| project IncidentNumber, Severity, CreatedTime, FirstModifiedTime, LastModifiedTime, Owner, ModifiedBy, SLA\r\n| summarize Incidents = count() by Severity)) on Severity, SLA\r\n| extend ExportColumn = strcat(Severity, '-', SLA)\r\n| extend Incidents = coalesce(Incidents, 0), Total = iff(isnotempty(SLA), coalesce(Total, 1), int(null))\r\n| extend Percent = Incidents / todouble(Total)\r\n| extend SevRank = case(Severity==\"High\", 1, Severity==\"Medium\", 2, Severity==\"Low\", 3, Severity==\"Informational\", 4, 5)\r\n| extend SlaRank = case(SLA==\"Green\", 1, SLA==\"Amber\", 2, SLA==\"Red\", 3, 0)\r\n| extend Severity = case(Severity==\"High\", strcat('ðŸŸ¥ ', Severity), Severity==\"Medium\", strcat('ðŸŸ§ ', Severity), Severity==\"Low\", strcat('ðŸŸ¨ ', Severity), Severity==\"Informational\", strcat('â¬œ ', Severity), Severity)\r\n| extend Incidents = iff(isempty(SLA), strcat(\"Total = \", tostring(Incidents)), tostring(Incidents))\r\n| sort by SevRank asc, SlaRank asc\r\n| extend Severity = coalesce(SLA, Severity)\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
                    "size": 3,
                    "title": "SLA by Severity",
                    "timeContextFromParameter": "TimeRange",
                    "exportFieldName": "ExportColumn",
                    "exportParameterName": "SelectedSLA",
                    "exportDefaultValue": "*",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Severity",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Green",
                                "representation": "dot-green",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Amber",
                                "representation": "dot-orange",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Red",
                                "representation": "dot-red",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "regex",
                                "thresholdValue": ".*",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{0}{1}"
                              }
                            ],
                            "customColumnWidthSetting": "20ch"
                          }
                        },
                        {
                          "columnMatch": "SLA",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "Incidents",
                          "formatter": 2,
                          "formatOptions": {
                            "customColumnWidthSetting": "15ch"
                          }
                        },
                        {
                          "columnMatch": "Total",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "ExportColumn",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "Percent",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "15ch"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "percent"
                            }
                          }
                        },
                        {
                          "columnMatch": "SevRank",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "SlaRank",
                          "formatter": 5
                        }
                      ],
                      "labelSettings": [
                        {
                          "columnId": "Severity",
                          "label": "Severity / SLA"
                        }
                      ]
                    }
                  },
                  "customWidth": "60",
                  "name": "sla_query",
                  "styleSettings": {
                    "margin": "10px",
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let Selected = '{SelectedSLA}';\r\nlet SelectedSeverity = tostring(coalesce(split(Selected, '-')[0], split(Selected, '-')[1]));\r\nlet SelectedSLA = iff(isnotempty(split(Selected, '-')[1]), tostring(split(Selected, '-')[1]), '*');\r\nlet base = SecurityIncident\r\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where isnotempty(Owner)\r\n| summarize arg_min(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| where Product == 'Microsoft Data Loss Prevention' or (Product == 'Microsoft 365 Defender' and Title startswith 'DLP')\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize make_set(Tactics))\r\n| extend TimeToTriage = datetime_diff('second', LastModifiedTime, CreatedTime)\r\n| extend SLA = LookupSLA(Severity, TimeToTriage/60.0);\r\nbase\r\n| where Severity == SelectedSeverity and (SLA ==  SelectedSLA or SelectedSLA == '*')\r\n| project SLA, IncidentNumber, Severity, Title, Owner, CreatedTime, FirstModifiedTime=LastModifiedTime, TimeToTriage, IncidentUrl",
                    "size": 3,
                    "title": "SLA Incident Drilldown",
                    "noDataMessage": "No incidents for the selected severity / SLA",
                    "noDataMessageStyle": 3,
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "SLA",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Green",
                                "representation": "dot-green",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Amber",
                                "representation": "dot-orange",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Red",
                                "representation": "dot-red",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "dot-gray",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Severity",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "20ch"
                          }
                        },
                        {
                          "columnMatch": "Title",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "70ch"
                          }
                        },
                        {
                          "columnMatch": "TimeToTriage",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "20ch"
                          },
                          "numberFormat": {
                            "unit": 24,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "IncidentUrl",
                          "formatter": 7,
                          "formatOptions": {
                            "linkTarget": "Url",
                            "linkLabel": "Link",
                            "customColumnWidthSetting": "20ch"
                          }
                        }
                      ],
                      "sortBy": [
                        {
                          "itemKey": "$gen_number_TimeToTriage_7",
                          "sortOrder": 2
                        }
                      ]
                    },
                    "sortBy": [
                      {
                        "itemKey": "$gen_number_TimeToTriage_7",
                        "sortOrder": 2
                      }
                    ]
                  },
                  "name": "sla_drilldown",
                  "styleSettings": {
                    "margin": "10px",
                    "showBorder": true
                  }
                }
              ]
            },
            "name": "sla_group",
            "styleSettings": {
              "margin": "10px",
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let base = SecurityIncident\r\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\r\n| where Status == 'Closed'\r\n| summarize arg_min(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where not(Status == 'Closed' and isempty(Owner))\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| where Product == 'Microsoft Data Loss Prevention' or (Product == 'Microsoft 365 Defender' and Title startswith 'DLP')\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize make_set(Tactics))\r\n| extend ttc = datetime_diff('second', ClosedTime, CreatedTime);\r\nunion (base | summarize ['Number of Incidents']=count(), MeanTTC=avg(ttc) | extend Severity = 'All'),\r\n(base | summarize ['Number of Incidents']=count(), MeanTTC=avg(ttc) by Severity)\r\n| extend Start = {TimeRange:start}, End = {TimeRange:end}\r\n| extend ['Mean Time to Close'] = case(MeanTTC >= 60 and MeanTTC < 3600, strcat(toint(MeanTTC / 60), \r\n                                                                                iff(toint(MeanTTC / 60) > 1, ' minutes ', ' minute '),\r\n                                                                                '\\n',\r\n                                                                                toint(round(MeanTTC % 60, 0)), \r\n                                                                                iff(toint(round(MeanTTC % 60, 0)) > 1, ' seconds', ' second')),\r\n                                        MeanTTC > 3600, strcat(toint(MeanTTC / 3600), \r\n                                                            iff(toint(MeanTTC / 3600) > 1, ' hours ', ' hour '), \r\n                                                            toint((MeanTTC % 3600) / 60), \r\n                                                            iff(toint(MeanTTC / 3600) > 1, ' minutes ', ' minute ')),\r\n                                        strcat(toint(round(MeanTTC % 60, 0)), \r\n                                            iff(toint(round(MeanTTC % 60, 0)) > 1, ' seconds', ' second')))\r\n| extend tempSeverity = case (Severity == 'All', 0, Severity == 'High', 1, Severity == 'Medium', 2,  Severity == 'Low', 3, Severity == 'informational', 4, 5)\r\n| project Start, End, SeverityAndCount = strcat(Severity, ' - ', ['Number of Incidents']), Severity, ['Number of Incidents'], ['Mean Time to Close'], MeanTTC = MeanTTC / 60, tempSeverity\r\n",
                    "size": 0,
                    "title": "Mean Time to Close",
                    "timeContextFromParameter": "TimeRange",
                    "showRefreshButton": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "SeverityAndCount",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "MeanTTC",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "auto"
                        },
                        "numberFormat": {
                          "unit": 25,
                          "options": {
                            "style": "decimal",
                            "maximumFractionDigits": 1
                          }
                        }
                      },
                      "secondaryContent": {
                        "columnMatch": "Mean Time to Close",
                        "formatter": 1
                      },
                      "showBorder": false,
                      "sortCriteriaField": "tempSeverity",
                      "sortOrderField": 1,
                      "size": "auto"
                    },
                    "graphSettings": {
                      "type": 0
                    },
                    "mapSettings": {
                      "locInfo": "LatLong",
                      "sizeSettings": "50th_Percentile",
                      "sizeAggregation": "Sum",
                      "legendMetric": "50th_Percentile",
                      "legendAggregation": "Sum",
                      "itemColorSettings": {
                        "type": "heatmap",
                        "colorAggregation": "Sum",
                        "nodeColorField": "50th_Percentile",
                        "heatmapPalette": "greenRed"
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "MTTC",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let base = SecurityIncident\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\n| where Status == 'Closed'\n| summarize arg_min(TimeGenerated, *) by IncidentNumber\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Owner = tostring(Owner.assignedTo)\n| where not(Status == 'Closed' and isempty(Owner))\n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\n| where Product in ({Product}) or \"*\" in ({Product})\n| where Product == 'Microsoft Data Loss Prevention' or (Product == 'Microsoft 365 Defender' and Title startswith 'DLP')\n| extend Tactics = todynamic(AdditionalData.tactics)\n| mv-apply Tactics to typeof(string) on (\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n    | summarize make_set(Tactics))\n| extend ttc = datetime_diff('second', ClosedTime, CreatedTime);\nunion (base | summarize ['Number of Incidents']=count(), MeanTTC=avg(ttc) | extend Owner = 'All'),\n(base | summarize ['Number of Incidents']=count(), MeanTTC=avg(ttc) by Owner)\n| extend ['Mean Time to Close'] = case(MeanTTC >= 60 and MeanTTC < 3600, strcat(toint(MeanTTC / 60), \n                                                                                iff(toint(MeanTTC / 60) > 1, ' minutes ', ' minute '),\n                                                                                '\\n',\n                                                                                toint(round(MeanTTC % 60, 0)), \n                                                                                iff(toint(round(MeanTTC % 60, 0)) > 1, ' seconds', ' second')),\n                                        MeanTTC > 3600, strcat(toint(MeanTTC / 3600), \n                                                            iff(toint(MeanTTC / 3600) > 1, ' hours ', ' hour '), \n                                                            toint((MeanTTC % 3600) / 60), \n                                                            iff(toint(MeanTTC / 3600) > 1, ' minutes ', ' minute ')),\n                                        strcat(toint(round(MeanTTC % 60, 0)), \n                                            iff(toint(round(MeanTTC % 60, 0)) > 1, ' seconds', ' second')))\n| project OwnerAndCount = strcat(Owner, ' - ', ['Number of Incidents']), Owner, ['Number of Incidents'], ['Mean Time to Close'], MeanTTC = MeanTTC / 60\n\n",
                    "size": 0,
                    "title": "Mean Time to Close by Owner",
                    "timeContextFromParameter": "TimeRange",
                    "showRefreshButton": true,
                    "exportFieldName": "series",
                    "exportParameterName": "Status",
                    "exportDefaultValue": "All",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "OwnerAndCount",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "MeanTTC",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "auto"
                        },
                        "numberFormat": {
                          "unit": 25,
                          "options": {
                            "style": "decimal",
                            "useGrouping": false,
                            "maximumFractionDigits": 1
                          }
                        }
                      },
                      "secondaryContent": {
                        "columnMatch": "Mean Time to Close",
                        "formatter": 1
                      },
                      "showBorder": false
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 2 - Copy",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "name": "group - mttc"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\r\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\r\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where not(Status == 'Closed' and isempty(Owner))\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| where Product == 'Microsoft Data Loss Prevention' or (Product == 'Microsoft 365 Defender' and Title startswith 'DLP')\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize make_set(Tactics))\r\n| where Status != 'Closed'\r\n| summarize Count=count() by Severity",
              "size": 0,
              "title": "Count of Incidents Under Investigation",
              "noDataMessage": "No incidents currently under investigation",
              "noDataMessageStyle": 3,
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "piechart",
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "Severity",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "dcount_IncidentNumber",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "query - 12",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\r\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\r\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where not(Status == 'Closed' and isempty(Owner))\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| where Product == 'Microsoft Data Loss Prevention' or (Product == 'Microsoft 365 Defender' and Title startswith 'DLP')\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize Tactics=make_set(Tactics))\r\n| where Status != 'Closed'\r\n| project CreatedTime, IncidentNumber, Title, Severity, Status, Owner, ProviderName, Product, IncidentUrl",
              "size": 0,
              "title": "Incidents Under Investigation",
              "noDataMessage": "No incidents currently under investigation",
              "noDataMessageStyle": 3,
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Severity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Low",
                          "representation": "Sev3",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Medium",
                          "representation": "Sev2",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "High",
                          "representation": "Sev1",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Sev4",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "IncidentUrl",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "Url",
                      "linkLabel": "Go to incident >"
                    }
                  }
                ],
                "labelSettings": [
                  {
                    "columnId": "CreatedTime",
                    "label": "Created Time"
                  },
                  {
                    "columnId": "IncidentNumber",
                    "label": "Incident Number"
                  },
                  {
                    "columnId": "Title",
                    "label": "Title"
                  },
                  {
                    "columnId": "Severity",
                    "label": "Severity"
                  },
                  {
                    "columnId": "Status",
                    "label": "Status"
                  },
                  {
                    "columnId": "Owner",
                    "label": "Owner"
                  },
                  {
                    "columnId": "ProviderName",
                    "label": "Provider"
                  },
                  {
                    "columnId": "Product",
                    "label": "Product"
                  },
                  {
                    "columnId": "IncidentUrl",
                    "label": "Link to Incident"
                  }
                ]
              },
              "sortBy": []
            },
            "customWidth": "50",
            "name": "query - 14",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\r\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\r\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where not(Status == 'Closed' and isempty(Owner))\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| where Product == 'Microsoft Data Loss Prevention' or (Product == 'Microsoft 365 Defender' and Title startswith 'DLP')\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize Tactics=make_set(Tactics))\r\n| where Severity == \"High\" and Status == \"Closed\"\r\n| project CreatedTime, IncidentNumber, Title, Severity, Owner, Status, ClosingClassification=strcat(Classification, ' - ', ClassificationReason), ClosingComment=ClassificationComment, ClosedTime, ProviderName, Product, IncidentUrl\r\n",
              "size": 0,
              "title": "High Severity Incidents",
              "noDataMessage": "No recent high severity incidents",
              "noDataMessageStyle": 3,
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Severity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Sev1",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "IncidentUrl",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "Url",
                      "linkLabel": "Go to incident >"
                    }
                  }
                ],
                "sortBy": [
                  {
                    "itemKey": "IncidentNumber",
                    "sortOrder": 1
                  }
                ],
                "labelSettings": [
                  {
                    "columnId": "CreatedTime",
                    "label": "Created Time"
                  },
                  {
                    "columnId": "IncidentNumber",
                    "label": "Incident Number"
                  },
                  {
                    "columnId": "Title",
                    "label": "Title"
                  },
                  {
                    "columnId": "Severity",
                    "label": "Severity"
                  },
                  {
                    "columnId": "Owner",
                    "label": "Owner"
                  },
                  {
                    "columnId": "Status",
                    "label": "Status"
                  },
                  {
                    "columnId": "ClosingClassification",
                    "label": "Closing Classification"
                  },
                  {
                    "columnId": "ClosingComment",
                    "label": "Closing Comment"
                  },
                  {
                    "columnId": "ClosedTime",
                    "label": "Closed Time"
                  },
                  {
                    "columnId": "ProviderName",
                    "label": "Provider"
                  },
                  {
                    "columnId": "Product",
                    "label": "Product"
                  },
                  {
                    "columnId": "IncidentUrl",
                    "label": "Link to Incident"
                  }
                ]
              },
              "sortBy": [
                {
                  "itemKey": "IncidentNumber",
                  "sortOrder": 1
                }
              ]
            },
            "customWidth": "50",
            "name": "query - 10",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\r\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\r\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where not(Status == 'Closed' and isempty(Owner))\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| where Product == 'Microsoft Data Loss Prevention' or (Product == 'Microsoft 365 Defender' and Title startswith 'DLP')\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize Tactics=make_set(Tactics))\r\n| where Status == 'Closed' and Classification == \"TruePositive\"\r\n| project CreatedTime, IncidentNumber, Title, Severity, Owner, Status, ClosingClassification=strcat(Classification, ' - ', ClassificationReason), ClosingComment=ClassificationComment, ClosedTime, ProviderName, Product, IncidentUrl\r\n",
              "size": 0,
              "title": "True Positive Incidents",
              "noDataMessage": "No recent true positive incidents",
              "noDataMessageStyle": 3,
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Severity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Low",
                          "representation": "Sev3",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Medium",
                          "representation": "Sev2",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "High",
                          "representation": "Sev1",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Sev4",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "IncidentUrl",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "Url",
                      "linkLabel": "Go to incident >"
                    }
                  }
                ],
                "sortBy": [
                  {
                    "itemKey": "IncidentNumber",
                    "sortOrder": 1
                  }
                ],
                "labelSettings": [
                  {
                    "columnId": "CreatedTime",
                    "label": "Created Time"
                  },
                  {
                    "columnId": "IncidentNumber",
                    "label": "Incident Number"
                  },
                  {
                    "columnId": "Title",
                    "label": "Title"
                  },
                  {
                    "columnId": "Severity",
                    "label": "Severity"
                  },
                  {
                    "columnId": "Owner",
                    "label": "Owner"
                  },
                  {
                    "columnId": "Status",
                    "label": "Status"
                  },
                  {
                    "columnId": "ClosingClassification",
                    "label": "Closing Classification"
                  },
                  {
                    "columnId": "ClosingComment",
                    "label": "Closing Comment"
                  },
                  {
                    "columnId": "ClosedTime",
                    "label": "Closed Time"
                  },
                  {
                    "columnId": "ProviderName",
                    "label": "Provider"
                  },
                  {
                    "columnId": "Product",
                    "label": "Product"
                  },
                  {
                    "columnId": "IncidentUrl",
                    "label": "Link to Incident"
                  }
                ]
              },
              "sortBy": [
                {
                  "itemKey": "IncidentNumber",
                  "sortOrder": 1
                }
              ]
            },
            "customWidth": "50",
            "name": "query - 10 - Copy",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Owner = tostring(Owner.assignedTo)\n| where not(Status == 'Closed' and isempty(Owner))\n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\n| where Product in ({Product}) or \"*\" in ({Product})\n| where Product == 'Microsoft Data Loss Prevention' or (Product == 'Microsoft 365 Defender' and Title startswith 'DLP')\n| extend Tactics = todynamic(AdditionalData.tactics)\n| mv-expand Tactics to typeof(string)\n| where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n| summarize Incidents=count() by Tactics, bin(CreatedTime, {TimeRange:grain})",
              "size": 0,
              "title": "Incident Tactics Over Time",
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "unstackedbar"
            },
            "customWidth": "50",
            "name": "query - 2 - Copy - Copy - Copy - Copy",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\r\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\r\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where not(Status == 'Closed' and isempty(Owner))\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| where Product == 'Microsoft Data Loss Prevention' or (Product == 'Microsoft 365 Defender' and Title startswith 'DLP')\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize make_set(Tactics))\r\n| summarize Count=count() by Title\r\n| sort by Count desc\r\n",
              "size": 0,
              "title": "Incident Count by Title",
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Title",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "95%"
                    }
                  },
                  {
                    "columnMatch": "Count",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "purpleBlueGreen",
                      "customColumnWidthSetting": "5%"
                    }
                  }
                ]
              },
              "sortBy": []
            },
            "customWidth": "50",
            "name": "query - 9",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Owner = tostring(Owner.assignedTo)\n| where not(Status == 'Closed' and isempty(Owner))\n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\n| where Product in ({Product}) or \"*\" in ({Product})\n| where Product == 'Microsoft Data Loss Prevention' or (Product == 'Microsoft 365 Defender' and Title startswith 'DLP')\n| extend Tactics = todynamic(AdditionalData.tactics)\n| mv-apply Tactics to typeof(string) on (\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n    | summarize Tactics=make_set(Tactics))\n| project LastModifiedTime, IncidentNumber, Title, Severity, Owner, Status, ProviderName, Product, IncidentUrl\n| top 50 by LastModifiedTime\n\n\n",
              "size": 0,
              "title": "Recent Incident Activity",
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "table",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Severity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Low",
                          "representation": "Sev3",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Medium",
                          "representation": "Sev2",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "High",
                          "representation": "Sev1",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Sev4",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "IncidentUrl",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "Url",
                      "linkLabel": "Go to incident >"
                    }
                  }
                ],
                "labelSettings": [
                  {
                    "columnId": "LastModifiedTime",
                    "label": "Last Modified Time"
                  },
                  {
                    "columnId": "IncidentNumber",
                    "label": "Incident Number"
                  },
                  {
                    "columnId": "Title",
                    "label": "Title"
                  },
                  {
                    "columnId": "Severity",
                    "label": "Severity"
                  },
                  {
                    "columnId": "Owner",
                    "label": "Owner"
                  },
                  {
                    "columnId": "Status",
                    "label": "Status"
                  },
                  {
                    "columnId": "ProviderName",
                    "label": "Provider"
                  },
                  {
                    "columnId": "Product",
                    "label": "Product"
                  },
                  {
                    "columnId": "IncidentUrl",
                    "label": "Link to Incident"
                  }
                ]
              },
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "Column1",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "IncidentNumber",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "name": "query - 2 - Copy - Copy - Copy - Copy",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Owner = tostring(Owner.assignedTo)\n| where not(Status == 'Closed' and isempty(Owner))\n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\n| where Product in ({Product}) or \"*\" in ({Product})\n| where Product == 'Microsoft Data Loss Prevention' or (Product == 'Microsoft 365 Defender' and Title startswith 'DLP')\n| extend Tactics = todynamic(AdditionalData.tactics)\n| mv-apply Tactics to typeof(string) on (\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n    | summarize Tactics=make_set(Tactics))\n| where Status == 'Closed'\n| project ClosedTime, IncidentNumber, Title, Severity, Owner, ClosingClassification=strcat(Classification, ' - ', ClassificationReason), ClosingComment=ClassificationComment, ProviderName, Product, IncidentUrl\n| top 50 by ClosedTime\n\n\n\n",
              "size": 0,
              "title": "Recent Incident Closings",
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "table",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Severity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Low",
                          "representation": "Sev3",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Medium",
                          "representation": "Sev2",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "High",
                          "representation": "Sev1",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Sev4",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "IncidentUrl",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "Url",
                      "linkLabel": "Go to incident >"
                    }
                  }
                ],
                "labelSettings": [
                  {
                    "columnId": "ClosedTime",
                    "label": "Closed Time"
                  },
                  {
                    "columnId": "IncidentNumber",
                    "label": "Incident Number"
                  },
                  {
                    "columnId": "Title",
                    "label": "Title"
                  },
                  {
                    "columnId": "Severity",
                    "label": "Severity"
                  },
                  {
                    "columnId": "Owner",
                    "label": "Owner"
                  },
                  {
                    "columnId": "ClosingClassification",
                    "label": "Closing Classification"
                  },
                  {
                    "columnId": "ClosingComment",
                    "label": "Closing Comment"
                  },
                  {
                    "columnId": "ProviderName",
                    "label": "Provider"
                  },
                  {
                    "columnId": "Product",
                    "label": "Product"
                  },
                  {
                    "columnId": "IncidentUrl",
                    "label": "Link to incident"
                  }
                ]
              },
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "Column1",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "IncidentNumber",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "name": "query - 2 - Copy - Copy - Copy - Copy",
            "styleSettings": {
              "showBorder": true
            }
          }
        ]
      },
      "conditionalVisibilities": [
        {
          "parameterName": "Tab",
          "comparison": "isEqualTo",
          "value": "dlp"
        },
        {
          "parameterName": "isDlpSelected",
          "comparison": "isNotEqualTo",
          "value": "-1"
        }
      ],
      "name": "group - 6 - Copy - Copy",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "2fd54280-faf8-40de-8aa2-c7f40c842704",
                  "version": "KqlParameterItem/1.0",
                  "name": "PhishingTitles",
                  "label": "Phishing Incident Names",
                  "type": 9,
                  "isRequired": true,
                  "multiSelect": true,
                  "quote": "'",
                  "delimiter": ",",
                  "jsonData": "[\"CS-127 - Darktrace - Antigena Email threat alert\", \r\n\"Email messages containing malicious file\", \r\n\"Email reported by user as malware or phish\", \r\n\"High Confidence Phish\", \r\n\"Initial access incident\", \r\n\"Phishing\", \r\n\"Phish delivered due to an IP allow policy\", \r\n\"Phish\"]",
                  "timeContext": {
                    "durationMs": 86400000
                  },
                  "defaultValue": "value::all",
                  "value": [
                    "Email messages containing malicious file",
                    "Email reported by user as malware or phish",
                    "High Confidence Phish",
                    "Initial access incident",
                    "Phishing",
                    "Phish delivered due to an IP allow policy",
                    "Phish"
                  ]
                },
                {
                  "id": "11f614b7-9ddd-4ffc-8e58-38eb622ad235",
                  "version": "KqlParameterItem/1.0",
                  "name": "OverrideTime",
                  "label": "Current Day Only",
                  "type": 10,
                  "description": "Use to ignore the current time range selection and only return results from 12am EST to now",
                  "isRequired": true,
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "jsonData": "[\r\n    { \"value\":1, \"label\":\"Yes\" },\r\n    { \"value\":-1, \"label\":\"No\", \"selected\":true }\r\n]",
                  "timeContext": {
                    "durationMs": 86400000
                  }
                }
              ],
              "style": "formVertical",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "name": "parameters - 13"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let startTime = iff({OverrideTime} == 1, datetime_local_to_utc(startofday(now()), 'US/Eastern'), {TimeRange:start});\nlet endTime = iff({OverrideTime} == 1, now(), {TimeRange:end});\nSecurityIncident\n| where CreatedTime between (startTime .. endTime)\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Owner = tostring(Owner.assignedTo)\n| where not(Status == 'Closed' and isempty(Owner))\n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\n| where Product in ({Product}) or \"*\" in ({Product})\n| extend Tactics = todynamic(AdditionalData.tactics)\n| mv-apply Tactics to typeof(string) on (\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n    | summarize make_set(Tactics))\n| where Title has_any ({PhishingTitles})\n| summarize count() by bin(CreatedTime, max_of({TimeRange:grain}, 1h)), Severity",
              "size": 0,
              "title": "Incidents Created Over Time",
              "timeBrushParameterName": "TimeRange",
              "timeBrushExportOnlyWhenBrushed": true,
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "barchart",
              "sortBy": [],
              "chartSettings": {
                "seriesLabelSettings": [
                  {
                    "seriesName": "count_",
                    "label": "Incidents"
                  }
                ],
                "ySettings": {
                  "numberFormatSettings": {
                    "unit": 17,
                    "options": {
                      "style": "decimal",
                      "useGrouping": true
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "Incidents over time ",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let startTime = iff({OverrideTime} == 1, datetime_local_to_utc(startofday(now()), 'US/Eastern'), {TimeRange:start});\nlet endTime = iff({OverrideTime} == 1, now(), {TimeRange:end});\nSecurityIncident\n| where CreatedTime between (startTime .. endTime)\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Owner = tostring(Owner.assignedTo)\n| where not(Status == 'Closed' and isempty(Owner))\n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\n| where Product in ({Product}) or \"*\" in ({Product})\n| extend Tactics = todynamic(AdditionalData.tactics)\n| mv-apply Tactics to typeof(string) on (\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n    | summarize make_set(Tactics))\n| where Title has_any ({PhishingTitles})\n| summarize count() by bin(ClosedTime, max_of({TimeRange:grain}, 1h)), Severity",
              "size": 0,
              "title": "Incidents Closed Over Time",
              "color": "green",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "barchart",
              "gridSettings": {
                "sortBy": [
                  {
                    "itemKey": "CreatedTime",
                    "sortOrder": 2
                  }
                ]
              },
              "sortBy": [
                {
                  "itemKey": "CreatedTime",
                  "sortOrder": 2
                }
              ],
              "chartSettings": {
                "seriesLabelSettings": [
                  {
                    "seriesName": "count_",
                    "label": "Incidents"
                  },
                  {
                    "seriesName": "Low",
                    "color": "grayBlue"
                  },
                  {
                    "seriesName": "Medium",
                    "color": "amethyst"
                  },
                  {
                    "seriesName": "High",
                    "color": "gray"
                  }
                ]
              }
            },
            "customWidth": "50",
            "name": "Incidents over time  - Copy",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let startTime = iff({OverrideTime} == 1, datetime_local_to_utc(startofday(now()), 'US/Eastern'), {TimeRange:start});\nlet endTime = iff({OverrideTime} == 1, now(), {TimeRange:end});\nSecurityIncident\n| where CreatedTime between (startTime .. endTime)\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Owner = tostring(Owner.assignedTo)\n| where not(Status == 'Closed' and isempty(Owner))\n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\n| where Product in ({Product}) or \"*\" in ({Product})\n| extend Tactics = todynamic(AdditionalData.tactics)\n| mv-apply Tactics to typeof(string) on (\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n    | summarize make_set(Tactics))\n| where Title has_any ({PhishingTitles})\n| where Status == 'Closed'\n| extend feedback = strcat(Classification,\": \",ClassificationReason)\n| extend feedback = case(feedback == 'TruePositive: SuspiciousActivity', 'True Positive: Suspicious activity',\n                         feedback == 'BenignPositive: SuspiciousButExpected', 'Benign Positive: Suspicious but expected',\n                         feedback == 'FalsePositive: IncorrectAlertLogic', 'False Positive: Incorrect alert logic',\n                         feedback == 'FalsePositive: InaccurateData', 'False Positive: Inaccurate data',\n                         'Undetermined')\n| summarize Count=count() by feedback\n| sort by Count desc\n",
              "size": 0,
              "title": "Incidents by Closing Classification",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "piechart",
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "feedback",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "Count",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "Incidents by classification - headline",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let startTime = iff({OverrideTime} == 1, datetime_local_to_utc(startofday(now()), 'US/Eastern'), {TimeRange:start});\r\nlet endTime = iff({OverrideTime} == 1, now(), {TimeRange:end});\r\nSecurityIncident\r\n| where CreatedTime between (startTime .. endTime)\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| where isempty(Owner) and Status == 'Closed'\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize Tactics=make_set(Tactics))\r\n| where Title has_any ({PhishingTitles})\r\n| project CreatedTime, IncidentNumber, Title, Severity, ModifiedBy, Status, Classification, ClassificationComment, ProviderName, Product, Tactics\r\n//| summarize count() by bin(CreatedTime, {TimeRange:grain})",
              "size": 0,
              "title": "Incidents Closed by Automation",
              "noDataMessage": "No recent incidents closed by Automation",
              "noDataMessageStyle": 3,
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Severity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Low",
                          "representation": "Sev3",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Medium",
                          "representation": "Sev2",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "High",
                          "representation": "Sev1",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Sev4",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  }
                ]
              },
              "graphSettings": {
                "type": 0
              }
            },
            "customWidth": "50",
            "name": "query - 13",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let base = SecurityIncident\r\n| where TimeGenerated between ({TimeRange:start} .. {TimeRange:end}) and Status == \"New\"\r\n| summarize arg_min(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| where Title has_any ({PhishingTitles})\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize make_set(Tactics))\r\n| project CreatedTime=TimeGenerated, IncidentNumber, Severity\r\n| join (SecurityIncident\r\n| where TimeGenerated between ({TimeRange:start} .. {TimeRange:end})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where isnotempty(Owner)\r\n| summarize arg_min(TimeGenerated, *) by IncidentNumber\r\n| project IncidentNumber, LastModifiedTime, Owner) on IncidentNumber\r\n| extend ttt = datetime_diff('second', LastModifiedTime, CreatedTime);\r\nunion (base | summarize ['Number of Incidents']=count(), MeanTTT=round(avg(ttt), 0) | extend Severity = 'All'),\r\n      (base | summarize ['Number of Incidents']=count(), MeanTTT=round(avg(ttt), 0) by Severity)\r\n| mv-apply ttt = split(split(MeanTTT * 1s, '.')[0], ':') on (\r\n    summarize ttt = make_list(toint(iff(ttt startswith \"0\", trim_start(\"0\", tostring(ttt)), ttt))))\r\n| extend ['Mean Time to Triage'] = strcat(iff(ttt[0] > 0, strcat(ttt[0], \" hours \"), \"\"), iff(ttt[1] > 0, strcat(ttt[1], \" minutes \"), \"\"), iff(ttt[2] > 0, strcat(ttt[2], \" seconds\"), \"\"))\r\n| extend tempSeverity = case (Severity == 'All', 0, Severity == 'High', 1, Severity == 'Medium', 2,  Severity == 'Low', 3, Severity == 'informational', 4, 5)\r\n| project SeverityAndCount = strcat(Severity, ' - ', ['Number of Incidents']), Severity, ['Number of Incidents'], ['Mean Time to Triage'], MeanTTT = MeanTTT / 60, tempSeverity",
                    "size": 0,
                    "title": "Mean Time to Triage",
                    "showRefreshButton": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "SeverityAndCount",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "MeanTTT",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "auto"
                        },
                        "numberFormat": {
                          "unit": 25,
                          "options": {
                            "style": "decimal",
                            "maximumFractionDigits": 1
                          }
                        }
                      },
                      "secondaryContent": {
                        "columnMatch": "Mean Time to Triage",
                        "formatter": 1
                      },
                      "showBorder": false,
                      "sortCriteriaField": "tempSeverity",
                      "sortOrderField": 1,
                      "size": "auto"
                    },
                    "graphSettings": {
                      "type": 0
                    },
                    "mapSettings": {
                      "locInfo": "LatLong",
                      "sizeSettings": "50th_Percentile",
                      "sizeAggregation": "Sum",
                      "legendMetric": "50th_Percentile",
                      "legendAggregation": "Sum",
                      "itemColorSettings": {
                        "type": "heatmap",
                        "colorAggregation": "Sum",
                        "nodeColorField": "50th_Percentile",
                        "heatmapPalette": "greenRed"
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "MTTT",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let base = SecurityIncident\r\n| where TimeGenerated between ({TimeRange:start} .. {TimeRange:end}) and Status == \"New\"\r\n| summarize arg_min(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| where Title has_any ({PhishingTitles})\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize make_set(Tactics))\r\n| project CreatedTime=TimeGenerated, IncidentNumber, Severity\r\n| join (SecurityIncident\r\n| where TimeGenerated between ({TimeRange:start} .. {TimeRange:end})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where isnotempty(Owner)\r\n| summarize arg_min(TimeGenerated, *) by IncidentNumber\r\n| project IncidentNumber, LastModifiedTime, Owner) on IncidentNumber\r\n| extend ttt = datetime_diff('second', LastModifiedTime, CreatedTime);\r\nunion (base | summarize ['Number of Incidents']=count(), MeanTTT=round(avg(ttt), 0) | extend Owner = 'All'),\r\n      (base | summarize ['Number of Incidents']=count(), MeanTTT=round(avg(ttt), 0) by Owner | sort by Owner asc)\r\n| mv-apply ttt = split(split(MeanTTT * 1s, '.')[0], ':') on (\r\n    summarize ttt = make_list(toint(iff(ttt startswith \"0\", trim_start(\"0\", tostring(ttt)), ttt))))\r\n| extend ['Mean Time to Triage'] = strcat(iff(ttt[0] > 0, strcat(ttt[0], \" hours \"), \"\"), iff(ttt[1] > 0, strcat(ttt[1], \" minutes \"), \"\"), iff(ttt[2] > 0, strcat(ttt[2], \" seconds\"), \"\"))\r\n| project OwnerAndCount = strcat(Owner, ' - ', ['Number of Incidents']), Owner, ['Number of Incidents'], ['Mean Time to Triage'], MeanTTT = MeanTTT / 60",
                    "size": 0,
                    "title": "Mean Time to Triage by Owner",
                    "showRefreshButton": true,
                    "exportFieldName": "series",
                    "exportParameterName": "Status",
                    "exportDefaultValue": "All",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "OwnerAndCount",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "MeanTTT",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "auto"
                        },
                        "numberFormat": {
                          "unit": 25,
                          "options": {
                            "style": "decimal",
                            "useGrouping": false,
                            "maximumFractionDigits": 1
                          }
                        }
                      },
                      "secondaryContent": {
                        "columnMatch": "Mean Time to Triage"
                      },
                      "showBorder": false
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 2 - Copy",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "name": "group - 13"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "title": "SLA Evaluation",
              "items": [
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": ""
                        },
                        "name": "text - 2"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "<h3>The time to triage for each incident is evaluated against the Time to Triage SLA Chart below and then assigned a color value. These colors represent how close the time to triage was to meeting the SLA threshold.</h3>\r\n<h4>Green = within SLA\r\n</br>Amber = missed SLA by small margin\r\n</br>Red = missed SLA by large margin</h4>",
                          "style": "upsell"
                        },
                        "name": "sla_group_table_title",
                        "styleSettings": {
                          "margin": "10px"
                        }
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": ""
                        },
                        "customWidth": "8",
                        "name": "text - 3"
                      },
                      {
                        "type": 1,
                        "content": {
                          "json": "<h4>Time to Triage SLA Chart</h4>\r\n<table>\r\n <thead>\r\n  <tr><th>Severity</th><th>Green</th><th>Amber</th><th>Red</th></tr>\r\n </thead>\r\n <tbody>\r\n <tr><td>High</td><td>< 15 minutes</td><td><= 20 minutes</td><td>> 20 minutes</td></tr>\r\n <tr><td>Medium</td><td>< 30 minutes</td><td><= 45 minutes</td><td>> 45 minutes</td></tr>\r\n <tr><td>Low</td><td>< 120 minutes</td><td><= 180 minutes</td><td>> 180 minutes</td></tr>\r\n <tr><td>Informational</td><td>< 120 minutes</td><td><= 180 minutes</td><td>> 180 minutes</td></tr>\r\n </tbody>\r\n</table>"
                        },
                        "customWidth": "85",
                        "name": "text - 0",
                        "styleSettings": {
                          "margin": "10px"
                        }
                      }
                    ]
                  },
                  "customWidth": "35",
                  "name": "group - 4",
                  "styleSettings": {
                    "margin": "10px"
                  }
                },
                {
                  "type": 1,
                  "content": {
                    "json": ""
                  },
                  "customWidth": "5",
                  "name": "text - 3"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let startTime = iff({OverrideTime} == 1, datetime_local_to_utc(startofday(now()), 'US/Eastern'), {TimeRange:start});\r\nlet endTime = iff({OverrideTime} == 1, now(), {TimeRange:end});\r\nlet base = SecurityIncident\r\n| where CreatedTime between (startTime .. endTime)\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where isnotempty(Owner)\r\n| summarize arg_min(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| where Title has_any ({PhishingTitles})\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize make_set(Tactics))\r\n| extend TimeToTriage = datetime_diff('second', LastModifiedTime, CreatedTime)\r\n| extend SLA = LookupSLA(Severity, TimeToTriage/60.0);\r\ndatatable ( Severity:string, SLA:string ) [ \r\n    \"High\", \"\",\r\n    \"High\", \"Green\",\r\n    \"High\", \"Amber\",\r\n    \"High\", \"Red\",\r\n    \"Medium\", \"\",\r\n    \"Medium\", \"Green\",\r\n    \"Medium\", \"Amber\",\r\n    \"Medium\", \"Red\",\r\n    \"Low\", \"\",\r\n    \"Low\", \"Green\",\r\n    \"Low\", \"Amber\",\r\n    \"Low\", \"Red\",\r\n    \"Informational\", \"\",\r\n    \"Informational\", \"Green\",\r\n    \"Informational\", \"Amber\",\r\n    \"Informational\", \"Red\"\r\n]\r\n| lookup kind=leftouter (base\r\n| project IncidentNumber, Severity, CreatedTime, FirstModifiedTime, LastModifiedTime, Owner, ModifiedBy, SLA\r\n| summarize Incidents = count() by Severity, SLA\r\n| lookup kind=leftouter (base\r\n| summarize Total = count() by Severity) on Severity\r\n| union (base\r\n| project IncidentNumber, Severity, CreatedTime, FirstModifiedTime, LastModifiedTime, Owner, ModifiedBy, SLA\r\n| summarize Incidents = count() by Severity)) on Severity, SLA\r\n| extend ExportColumn = strcat(Severity, '-', SLA)\r\n| extend Incidents = coalesce(Incidents, 0), Total = iff(isnotempty(SLA), coalesce(Total, 1), int(null))\r\n| extend Percent = Incidents / todouble(Total)\r\n| extend SevRank = case(Severity==\"High\", 1, Severity==\"Medium\", 2, Severity==\"Low\", 3, Severity==\"Informational\", 4, 5)\r\n| extend SlaRank = case(SLA==\"Green\", 1, SLA==\"Amber\", 2, SLA==\"Red\", 3, 0)\r\n| extend Severity = case(Severity==\"High\", strcat('ðŸŸ¥ ', Severity), Severity==\"Medium\", strcat('ðŸŸ§ ', Severity), Severity==\"Low\", strcat('ðŸŸ¨ ', Severity), Severity==\"Informational\", strcat('â¬œ ', Severity), Severity)\r\n| extend Incidents = iff(isempty(SLA), strcat(\"Total = \", tostring(Incidents)), tostring(Incidents))\r\n| sort by SevRank asc, SlaRank asc\r\n| extend Severity = coalesce(SLA, Severity)\r\n\r\n\r\n\r\n\r\n\r\n\r\n",
                    "size": 3,
                    "title": "SLA by Severity",
                    "timeContextFromParameter": "TimeRange",
                    "exportFieldName": "ExportColumn",
                    "exportParameterName": "SelectedSLA",
                    "exportDefaultValue": "*",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "Severity",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Green",
                                "representation": "dot-green",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Amber",
                                "representation": "dot-orange",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Red",
                                "representation": "dot-red",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "regex",
                                "thresholdValue": ".*",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "unknown",
                                "text": "{0}{1}"
                              }
                            ],
                            "customColumnWidthSetting": "20ch"
                          }
                        },
                        {
                          "columnMatch": "SLA",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "Incidents",
                          "formatter": 2,
                          "formatOptions": {
                            "customColumnWidthSetting": "15ch"
                          }
                        },
                        {
                          "columnMatch": "Total",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "ExportColumn",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "Percent",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "15ch"
                          },
                          "numberFormat": {
                            "unit": 0,
                            "options": {
                              "style": "percent"
                            }
                          }
                        },
                        {
                          "columnMatch": "SevRank",
                          "formatter": 5
                        },
                        {
                          "columnMatch": "SlaRank",
                          "formatter": 5
                        }
                      ],
                      "labelSettings": [
                        {
                          "columnId": "Severity",
                          "label": "Severity / SLA"
                        }
                      ]
                    }
                  },
                  "customWidth": "60",
                  "name": "sla_query",
                  "styleSettings": {
                    "margin": "10px",
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let Selected = '{SelectedSLA}';\r\nlet SelectedSeverity = tostring(coalesce(split(Selected, '-')[0], split(Selected, '-')[1]));\r\nlet SelectedSLA = iff(isnotempty(split(Selected, '-')[1]), tostring(split(Selected, '-')[1]), '*');\r\nlet startTime = iff({OverrideTime} == 1, datetime_local_to_utc(startofday(now()), 'US/Eastern'), {TimeRange:start});\r\nlet endTime = iff({OverrideTime} == 1, now(), {TimeRange:end});\r\nlet base = SecurityIncident\r\n| where CreatedTime between (startTime .. endTime)\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where isnotempty(Owner)\r\n| summarize arg_min(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| where Title has_any ({PhishingTitles})\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize make_set(Tactics))\r\n| extend TimeToTriage = datetime_diff('second', LastModifiedTime, CreatedTime)\r\n| extend SLA = LookupSLA(Severity, TimeToTriage/60.0);\r\nbase\r\n| where Severity == SelectedSeverity and (SLA ==  SelectedSLA or SelectedSLA == '*')\r\n| project SLA, IncidentNumber, Severity, Title, Owner, CreatedTime, FirstModifiedTime=LastModifiedTime, TimeToTriage, IncidentUrl",
                    "size": 3,
                    "title": "SLA Incident Drilldown",
                    "noDataMessage": "No incidents for the selected severity / SLA",
                    "noDataMessageStyle": 3,
                    "timeContextFromParameter": "TimeRange",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "gridSettings": {
                      "formatters": [
                        {
                          "columnMatch": "SLA",
                          "formatter": 18,
                          "formatOptions": {
                            "thresholdsOptions": "icons",
                            "thresholdsGrid": [
                              {
                                "operator": "==",
                                "thresholdValue": "Green",
                                "representation": "dot-green",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Amber",
                                "representation": "dot-orange",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "==",
                                "thresholdValue": "Red",
                                "representation": "dot-red",
                                "text": "{0}{1}"
                              },
                              {
                                "operator": "Default",
                                "thresholdValue": null,
                                "representation": "dot-gray",
                                "text": "{0}{1}"
                              }
                            ]
                          }
                        },
                        {
                          "columnMatch": "Severity",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "20ch"
                          }
                        },
                        {
                          "columnMatch": "Title",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "70ch"
                          }
                        },
                        {
                          "columnMatch": "TimeToTriage",
                          "formatter": 0,
                          "formatOptions": {
                            "customColumnWidthSetting": "20ch"
                          },
                          "numberFormat": {
                            "unit": 24,
                            "options": {
                              "style": "decimal",
                              "maximumFractionDigits": 2
                            }
                          }
                        },
                        {
                          "columnMatch": "IncidentUrl",
                          "formatter": 7,
                          "formatOptions": {
                            "linkTarget": "Url",
                            "linkLabel": "Link",
                            "customColumnWidthSetting": "20ch"
                          }
                        }
                      ],
                      "sortBy": [
                        {
                          "itemKey": "$gen_number_TimeToTriage_7",
                          "sortOrder": 2
                        }
                      ]
                    },
                    "sortBy": [
                      {
                        "itemKey": "$gen_number_TimeToTriage_7",
                        "sortOrder": 2
                      }
                    ]
                  },
                  "name": "sla_drilldown",
                  "styleSettings": {
                    "margin": "10px",
                    "showBorder": true
                  }
                }
              ]
            },
            "name": "sla_group",
            "styleSettings": {
              "margin": "10px",
              "showBorder": true
            }
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let startTime = iff({OverrideTime} == 1, datetime_local_to_utc(startofday(now()), 'US/Eastern'), {TimeRange:start});\r\nlet endTime = iff({OverrideTime} == 1, now(), {TimeRange:end});\r\nlet base = SecurityIncident\r\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\r\n| where Status == 'Closed'\r\n| summarize arg_min(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where not(Status == 'Closed' and isempty(Owner))\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize make_set(Tactics))\r\n| where Title has_any ({PhishingTitles})\r\n| extend ttc = datetime_diff('second', ClosedTime, CreatedTime);\r\nunion (base | summarize ['Number of Incidents']=count(), MeanTTC=avg(ttc) | extend Severity = 'All'),\r\n(base | summarize ['Number of Incidents']=count(), MeanTTC=avg(ttc) by Severity)\r\n| extend Start = {TimeRange:start}, End = {TimeRange:end}\r\n| extend ['Mean Time to Close'] = case(MeanTTC >= 60 and MeanTTC < 3600, strcat(toint(MeanTTC / 60), \r\n                                                                                iff(toint(MeanTTC / 60) > 1, ' minutes ', ' minute '),\r\n                                                                                '\\n',\r\n                                                                                toint(round(MeanTTC % 60, 0)), \r\n                                                                                iff(toint(round(MeanTTC % 60, 0)) > 1, ' seconds', ' second')),\r\n                                        MeanTTC > 3600, strcat(toint(MeanTTC / 3600), \r\n                                                            iff(toint(MeanTTC / 3600) > 1, ' hours ', ' hour '), \r\n                                                            toint((MeanTTC % 3600) / 60), \r\n                                                            iff(toint(MeanTTC / 3600) > 1, ' minutes ', ' minute ')),\r\n                                        strcat(toint(round(MeanTTC % 60, 0)), \r\n                                            iff(toint(round(MeanTTC % 60, 0)) > 1, ' seconds', ' second')))\r\n| extend tempSeverity = case (Severity == 'All', 0, Severity == 'High', 1, Severity == 'Medium', 2,  Severity == 'Low', 3, Severity == 'informational', 4, 5)\r\n| project Start, End, SeverityAndCount = strcat(Severity, ' - ', ['Number of Incidents']), Severity, ['Number of Incidents'], ['Mean Time to Close'], MeanTTC = MeanTTC / 60, tempSeverity\r\n",
                    "size": 0,
                    "title": "Mean Time to Close",
                    "timeContextFromParameter": "TimeRange",
                    "showRefreshButton": true,
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "SeverityAndCount",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "MeanTTC",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "auto"
                        },
                        "numberFormat": {
                          "unit": 25,
                          "options": {
                            "style": "decimal",
                            "maximumFractionDigits": 1
                          }
                        }
                      },
                      "secondaryContent": {
                        "columnMatch": "Mean Time to Close",
                        "formatter": 1
                      },
                      "showBorder": false,
                      "sortCriteriaField": "tempSeverity",
                      "sortOrderField": 1,
                      "size": "auto"
                    },
                    "graphSettings": {
                      "type": 0
                    },
                    "mapSettings": {
                      "locInfo": "LatLong",
                      "sizeSettings": "50th_Percentile",
                      "sizeAggregation": "Sum",
                      "legendMetric": "50th_Percentile",
                      "legendAggregation": "Sum",
                      "itemColorSettings": {
                        "type": "heatmap",
                        "colorAggregation": "Sum",
                        "nodeColorField": "50th_Percentile",
                        "heatmapPalette": "greenRed"
                      }
                    }
                  },
                  "customWidth": "50",
                  "name": "MTTC",
                  "styleSettings": {
                    "showBorder": true
                  }
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "let startTime = iff({OverrideTime} == 1, datetime_local_to_utc(startofday(now()), 'US/Eastern'), {TimeRange:start});\nlet endTime = iff({OverrideTime} == 1, now(), {TimeRange:end});\nlet base = SecurityIncident\n| where CreatedTime between ({TimeRange:start} .. {TimeRange:end})\n| where Status == 'Closed'\n| summarize arg_min(TimeGenerated, *) by IncidentNumber\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Owner = tostring(Owner.assignedTo)\n| where not(Status == 'Closed' and isempty(Owner))\n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\n| where Product in ({Product}) or \"*\" in ({Product})\n| extend Tactics = todynamic(AdditionalData.tactics)\n| mv-apply Tactics to typeof(string) on (\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n    | summarize make_set(Tactics))\n| where Title has_any ({PhishingTitles})\n| extend ttc = datetime_diff('second', ClosedTime, CreatedTime);\nunion (base | summarize ['Number of Incidents']=count(), MeanTTC=avg(ttc) | extend Owner = 'All'),\n(base | summarize ['Number of Incidents']=count(), MeanTTC=avg(ttc) by Owner)\n| extend ['Mean Time to Close'] = case(MeanTTC >= 60 and MeanTTC < 3600, strcat(toint(MeanTTC / 60), \n                                                                                iff(toint(MeanTTC / 60) > 1, ' minutes ', ' minute '),\n                                                                                '\\n',\n                                                                                toint(round(MeanTTC % 60, 0)), \n                                                                                iff(toint(round(MeanTTC % 60, 0)) > 1, ' seconds', ' second')),\n                                        MeanTTC > 3600, strcat(toint(MeanTTC / 3600), \n                                                            iff(toint(MeanTTC / 3600) > 1, ' hours ', ' hour '), \n                                                            toint((MeanTTC % 3600) / 60), \n                                                            iff(toint(MeanTTC / 3600) > 1, ' minutes ', ' minute ')),\n                                        strcat(toint(round(MeanTTC % 60, 0)), \n                                            iff(toint(round(MeanTTC % 60, 0)) > 1, ' seconds', ' second')))\n| project OwnerAndCount = strcat(Owner, ' - ', ['Number of Incidents']), Owner, ['Number of Incidents'], ['Mean Time to Close'], MeanTTC = MeanTTC / 60\n\n",
                    "size": 0,
                    "title": "Mean Time to Close by Owner",
                    "timeContextFromParameter": "TimeRange",
                    "showRefreshButton": true,
                    "exportFieldName": "series",
                    "exportParameterName": "Status",
                    "exportDefaultValue": "All",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspace}"
                    ],
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "OwnerAndCount",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "MeanTTC",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "auto"
                        },
                        "numberFormat": {
                          "unit": 25,
                          "options": {
                            "style": "decimal",
                            "useGrouping": false,
                            "maximumFractionDigits": 1
                          }
                        }
                      },
                      "secondaryContent": {
                        "columnMatch": "Mean Time to Close",
                        "formatter": 1
                      },
                      "showBorder": false
                    }
                  },
                  "customWidth": "50",
                  "name": "query - 2 - Copy",
                  "styleSettings": {
                    "showBorder": true
                  }
                }
              ]
            },
            "name": "group - mttc"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let startTime = iff({OverrideTime} == 1, datetime_local_to_utc(startofday(now()), 'US/Eastern'), {TimeRange:start});\r\nlet endTime = iff({OverrideTime} == 1, now(), {TimeRange:end});\r\nSecurityIncident\r\n| where CreatedTime between (startTime .. endTime)\r\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where not(Status == 'Closed' and isempty(Owner))\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize make_set(Tactics))\r\n| where Title has_any ({PhishingTitles})\r\n| where Status != 'Closed'\r\n| summarize Count=count() by Severity",
              "size": 0,
              "title": "Count of Incidents Under Investigation",
              "noDataMessage": "No incidents currently under investigation",
              "noDataMessageStyle": 3,
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "visualization": "piechart",
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "Severity",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "dcount_IncidentNumber",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "customWidth": "50",
            "name": "query - 12",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let startTime = iff({OverrideTime} == 1, datetime_local_to_utc(startofday(now()), 'US/Eastern'), {TimeRange:start});\r\nlet endTime = iff({OverrideTime} == 1, now(), {TimeRange:end});\r\nSecurityIncident\r\n| where CreatedTime between (startTime .. endTime)\r\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where not(Status == 'Closed' and isempty(Owner))\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize Tactics=make_set(Tactics))\r\n| where Title has_any ({PhishingTitles})\r\n| where Status != 'Closed'\r\n| project CreatedTime, IncidentNumber, Title, Severity, Status, Owner, ProviderName, Product, IncidentUrl",
              "size": 0,
              "title": "Incidents Under Investigation",
              "noDataMessage": "No incidents currently under investigation",
              "noDataMessageStyle": 3,
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Severity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Low",
                          "representation": "Sev3",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Medium",
                          "representation": "Sev2",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "High",
                          "representation": "Sev1",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Sev4",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "IncidentUrl",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "Url",
                      "linkLabel": "Go to incident >"
                    }
                  }
                ],
                "labelSettings": [
                  {
                    "columnId": "CreatedTime",
                    "label": "Created Time"
                  },
                  {
                    "columnId": "IncidentNumber",
                    "label": "Incident Number"
                  },
                  {
                    "columnId": "Title",
                    "label": "Title"
                  },
                  {
                    "columnId": "Severity",
                    "label": "Severity"
                  },
                  {
                    "columnId": "Status",
                    "label": "Status"
                  },
                  {
                    "columnId": "Owner",
                    "label": "Owner"
                  },
                  {
                    "columnId": "ProviderName",
                    "label": "Provider"
                  },
                  {
                    "columnId": "Product",
                    "label": "Product"
                  },
                  {
                    "columnId": "IncidentUrl",
                    "label": "Link to Incident"
                  }
                ]
              },
              "sortBy": []
            },
            "customWidth": "50",
            "name": "query - 14",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let startTime = iff({OverrideTime} == 1, datetime_local_to_utc(startofday(now()), 'US/Eastern'), {TimeRange:start});\r\nlet endTime = iff({OverrideTime} == 1, now(), {TimeRange:end});\r\nlet BaseDataset = SecurityIncident\r\n| where CreatedTime between (startTime .. endTime)\r\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where not(Status == 'Closed' and isempty(Owner))\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize Tactics=make_set(Tactics))\r\n| where Title has_any ({PhishingTitles});\r\nlet highestSeverity = toscalar(BaseDataset\r\n| extend SeverityInt = case(Severity == 'High', 4, Severity == 'Medium', 3, Severity == 'Low', 2, 1)\r\n| summarize arg_max(SeverityInt, Severity)\r\n| project Severity);\r\nBaseDataset\r\n| where Severity == highestSeverity and Status == \"Closed\"\r\n| project CreatedTime, IncidentNumber, Title, Severity, Owner, Status, ClosingClassification=strcat(Classification, ' - ', ClassificationReason), ClosingComment=ClassificationComment, ClosedTime, ProviderName, Product, IncidentUrl\r\n",
              "size": 0,
              "title": "Highest Severity Incidents",
              "noDataMessage": "No recent incidents",
              "noDataMessageStyle": 3,
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Severity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Sev1",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "IncidentUrl",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "Url",
                      "linkLabel": "Go to incident >"
                    }
                  }
                ]
              },
              "sortBy": []
            },
            "customWidth": "50",
            "name": "query - 10",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let startTime = iff({OverrideTime} == 1, datetime_local_to_utc(startofday(now()), 'US/Eastern'), {TimeRange:start});\r\nlet endTime = iff({OverrideTime} == 1, now(), {TimeRange:end});\r\nSecurityIncident\r\n| where CreatedTime between (startTime .. endTime)\r\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where not(Status == 'Closed' and isempty(Owner))\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize Tactics=make_set(Tactics))\r\n| where Title has_any ({PhishingTitles})\r\n| where Status == 'Closed' and Classification == \"TruePositive\"\r\n| project CreatedTime, IncidentNumber, Title, Severity, Owner, Status, ClosingClassification=strcat(Classification, ' - ', ClassificationReason), ClosingComment=ClassificationComment, ClosedTime, ProviderName, Product, IncidentUrl\r\n",
              "size": 0,
              "title": "True Positive Incidents",
              "noDataMessage": "No recent true positive incidents",
              "noDataMessageStyle": 3,
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Severity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Low",
                          "representation": "Sev3",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Medium",
                          "representation": "Sev2",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "High",
                          "representation": "Sev1",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Sev4",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "IncidentUrl",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "Url",
                      "linkLabel": "Go to incident >"
                    }
                  }
                ],
                "sortBy": [
                  {
                    "itemKey": "IncidentNumber",
                    "sortOrder": 1
                  }
                ],
                "labelSettings": [
                  {
                    "columnId": "CreatedTime",
                    "label": "Created Time"
                  },
                  {
                    "columnId": "IncidentNumber",
                    "label": "Incident Number"
                  },
                  {
                    "columnId": "Title",
                    "label": "Title"
                  },
                  {
                    "columnId": "Severity",
                    "label": "Severity"
                  },
                  {
                    "columnId": "Owner",
                    "label": "Owner"
                  },
                  {
                    "columnId": "Status",
                    "label": "Status"
                  },
                  {
                    "columnId": "ClosingClassification",
                    "label": "Closing Classification"
                  },
                  {
                    "columnId": "ClosingComment",
                    "label": "Closing Comment"
                  },
                  {
                    "columnId": "ClosedTime",
                    "label": "Closed Time"
                  },
                  {
                    "columnId": "ProviderName",
                    "label": "Provider"
                  },
                  {
                    "columnId": "Product",
                    "label": "Product"
                  },
                  {
                    "columnId": "IncidentUrl",
                    "label": "Link to Incident"
                  }
                ]
              },
              "sortBy": [
                {
                  "itemKey": "IncidentNumber",
                  "sortOrder": 1
                }
              ]
            },
            "customWidth": "50",
            "name": "query - 10 - Copy",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let startTime = iff({OverrideTime} == 1, datetime_local_to_utc(startofday(now()), 'US/Eastern'), {TimeRange:start});\nlet endTime = iff({OverrideTime} == 1, now(), {TimeRange:end});\nSecurityIncident\n| where CreatedTime between (startTime .. endTime)\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Owner = tostring(Owner.assignedTo)\n| where not(Status == 'Closed' and isempty(Owner))\n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\n| where Product in ({Product}) or \"*\" in ({Product})\n| extend Tactics = todynamic(AdditionalData.tactics)\n| mv-expand Tactics to typeof(string)\n| where Title has_any ({PhishingTitles})\n| where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n| summarize Incidents=count() by Tactics, bin(CreatedTime, {TimeRange:grain})",
              "size": 0,
              "title": "Incident Tactics Over Time",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "unstackedbar"
            },
            "customWidth": "50",
            "name": "query - 2 - Copy - Copy - Copy - Copy",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let startTime = iff({OverrideTime} == 1, datetime_local_to_utc(startofday(now()), 'US/Eastern'), {TimeRange:start});\r\nlet endTime = iff({OverrideTime} == 1, now(), {TimeRange:end});\r\nSecurityIncident\r\n| where CreatedTime between (startTime .. endTime)\r\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\r\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| extend Owner = tostring(Owner.assignedTo)\r\n| where not(Status == 'Closed' and isempty(Owner))\r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mv-apply Tactics to typeof(string) on (\r\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n    | summarize make_set(Tactics))\r\n| where Title has_any ({PhishingTitles})\r\n| summarize Count=count() by Title\r\n| sort by Count desc\r\n",
              "size": 0,
              "title": "Incident Count by Title",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Title",
                    "formatter": 0,
                    "formatOptions": {
                      "customColumnWidthSetting": "95%"
                    }
                  },
                  {
                    "columnMatch": "Count",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "purpleBlueGreen",
                      "customColumnWidthSetting": "5%"
                    }
                  }
                ]
              },
              "sortBy": []
            },
            "customWidth": "50",
            "name": "query - 9",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let startTime = iff({OverrideTime} == 1, datetime_local_to_utc(startofday(now()), 'US/Eastern'), {TimeRange:start});\nlet endTime = iff({OverrideTime} == 1, now(), {TimeRange:end});\nSecurityIncident\n| where CreatedTime between (startTime .. endTime)\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Owner = tostring(Owner.assignedTo)\n| where not(Status == 'Closed' and isempty(Owner))\n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\n| where Product in ({Product}) or \"*\" in ({Product})\n| extend Tactics = todynamic(AdditionalData.tactics)\n| mv-apply Tactics to typeof(string) on (\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n    | summarize Tactics=make_set(Tactics))\n| where Title has_any ({PhishingTitles})\n| project LastModifiedTime, IncidentNumber, Title, Severity, Owner, Status, ProviderName, Product, IncidentUrl\n| top 50 by LastModifiedTime\n\n\n",
              "size": 0,
              "title": "Recent Incident Activity",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "table",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Severity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Low",
                          "representation": "Sev3",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Medium",
                          "representation": "Sev2",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "High",
                          "representation": "Sev1",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Sev4",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "IncidentUrl",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "Url",
                      "linkLabel": "Go to incident >"
                    }
                  }
                ],
                "labelSettings": [
                  {
                    "columnId": "LastModifiedTime",
                    "label": "Last Modified Time"
                  },
                  {
                    "columnId": "IncidentNumber",
                    "label": "Incident Number"
                  },
                  {
                    "columnId": "Title",
                    "label": "Title"
                  },
                  {
                    "columnId": "Severity",
                    "label": "Severity"
                  },
                  {
                    "columnId": "Owner",
                    "label": "Owner"
                  },
                  {
                    "columnId": "Status",
                    "label": "Status"
                  },
                  {
                    "columnId": "ProviderName",
                    "label": "Provider"
                  },
                  {
                    "columnId": "Product",
                    "label": "Product"
                  },
                  {
                    "columnId": "IncidentUrl",
                    "label": "Link to Incident"
                  }
                ]
              },
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "Column1",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "IncidentNumber",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "name": "query - 2 - Copy - Copy - Copy - Copy",
            "styleSettings": {
              "showBorder": true
            }
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "let startTime = iff({OverrideTime} == 1, datetime_local_to_utc(startofday(now()), 'US/Eastern'), {TimeRange:start});\nlet endTime = iff({OverrideTime} == 1, now(), {TimeRange:end});\nSecurityIncident\n| where CreatedTime between (startTime .. endTime)\n| summarize arg_max(TimeGenerated, *) by IncidentNumber\n| where ProviderName in ({Provider}) or \"*\" in ({Provider})\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Owner = tostring(Owner.assignedTo)\n| where not(Status == 'Closed' and isempty(Owner))\n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = coalesce(tostring(AdditionalData.alertProductNames[0]), ProviderName)\n| where Product in ({Product}) or \"*\" in ({Product})\n| extend Tactics = todynamic(AdditionalData.tactics)\n| mv-apply Tactics to typeof(string) on (\n    where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n    | summarize Tactics=make_set(Tactics))\n| where Title has_any ({PhishingTitles})\n| where Status == 'Closed'\n| project ClosedTime, IncidentNumber, Title, Severity, Owner, ClosingClassification=strcat(Classification, ' - ', ClassificationReason), ClosingComment=ClassificationComment, ProviderName, Product, IncidentUrl\n| top 50 by ClosedTime\n\n\n\n",
              "size": 0,
              "title": "Recent Incident Closings",
              "showRefreshButton": true,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "visualization": "table",
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Severity",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "icons",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "Low",
                          "representation": "Sev3",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "Medium",
                          "representation": "Sev2",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "High",
                          "representation": "Sev1",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "Sev4",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "IncidentUrl",
                    "formatter": 7,
                    "formatOptions": {
                      "linkTarget": "Url",
                      "linkLabel": "Go to incident >"
                    }
                  }
                ],
                "labelSettings": [
                  {
                    "columnId": "ClosedTime",
                    "label": "Closed Time"
                  },
                  {
                    "columnId": "IncidentNumber",
                    "label": "Incident Number"
                  },
                  {
                    "columnId": "Title",
                    "label": "Title"
                  },
                  {
                    "columnId": "Severity",
                    "label": "Severity"
                  },
                  {
                    "columnId": "Owner",
                    "label": "Owner"
                  },
                  {
                    "columnId": "ClosingClassification",
                    "label": "Closing Classification"
                  },
                  {
                    "columnId": "ClosingComment",
                    "label": "Closing Comment"
                  },
                  {
                    "columnId": "ProviderName",
                    "label": "Provider"
                  },
                  {
                    "columnId": "Product",
                    "label": "Product"
                  },
                  {
                    "columnId": "IncidentUrl",
                    "label": "Link to incident"
                  }
                ]
              },
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "Column1",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "IncidentNumber",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "name": "query - 2 - Copy - Copy - Copy - Copy",
            "styleSettings": {
              "showBorder": true
            }
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "Tab",
        "comparison": "isEqualTo",
        "value": "phish"
      },
      "name": "group - 6 - Copy - Copy",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "items": [
          {
            "type": 9,
            "content": {
              "version": "KqlParameterItem/1.0",
              "parameters": [
                {
                  "id": "7e985447-1426-44cc-9c80-75aad9458b93",
                  "version": "KqlParameterItem/1.0",
                  "name": "LastLogRecivedThreshold",
                  "label": "Last log threshold",
                  "type": 2,
                  "description": "Select the last log recived threshold",
                  "isRequired": true,
                  "typeSettings": {
                    "additionalResourceOptions": [],
                    "showDefault": false
                  },
                  "jsonData": "[\t{\r\n\t\t\"value\": \"0\",\r\n\t\t\"label\": \"None\",\r\n\t\t\"selected\": true\r\n\t},\r\n\t{\r\n\t\t\"value\": \"60\",\r\n\t\t\"label\": \"1m\"\r\n\t},\r\n\t{\r\n\t\t\"value\": \"300\",\r\n\t\t\"label\": \"5m\"\r\n\t},\r\n\t{\r\n\t\t\"value\": \"900\",\r\n\t\t\"label\": \"15m\"\r\n\t},\r\n\t{\r\n\t\t\"value\": \"1800\",\r\n\t\t\"label\": \"30m\"\r\n\t},\r\n\t{\r\n\t\t\"value\": \"3600\",\r\n\t\t\"label\": \"1h\"\r\n\t},\r\n\t{\r\n\t\t\"value\": \"7200\",\r\n\t\t\"label\": \"2h\"\r\n\t},\r\n\t{\r\n\t\t\"value\": \"14400\",\r\n\t\t\"label\": \"4h\"\r\n\t},\r\n\t{\r\n\t\t\"value\": \"21600\",\r\n\t\t\"label\": \"6h\"\r\n\t},\r\n\t{\r\n\t\t\"value\": \"43200\",\r\n\t\t\"label\": \"12h\"\r\n\t},\r\n\t{\r\n\t\t\"value\": \"86400\",\r\n\t\t\"label\": \"1d\"\r\n\t}\r\n]",
                  "timeContext": {
                    "durationMs": 86400000
                  }
                }
              ],
              "style": "pills",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces"
            },
            "name": "parameters - 8"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "union withsource = _TableName *\r\n| summarize last_log = datetime_diff(\"second\", now(), max(TimeGenerated))  by _TableName\r\n| where last_log > {LastLogRecivedThreshold}\r\n| project ['Table Name'] = _TableName,  ['Last Record Received'] =  last_log \r\n | order by ['Last Record Received']  desc\r\n\r\n ",
              "size": 0,
              "showAnalytics": true,
              "title": "Last Data Received by Table",
              "noDataMessage": "All tables ingested logs within specified threshold",
              "noDataMessageStyle": 3,
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "exportFieldName": "Table Name",
              "exportParameterName": "Table",
              "exportDefaultValue": "All Tables",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Last Record Received",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "orangeRed"
                    },
                    "numberFormat": {
                      "unit": 24,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false,
                        "maximumSignificantDigits": 2
                      }
                    }
                  },
                  {
                    "columnMatch": "Table Size",
                    "formatter": 3,
                    "formatOptions": {
                      "min": 0,
                      "palette": "coldHot"
                    },
                    "numberFormat": {
                      "unit": 2,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  },
                  {
                    "columnMatch": "Table Entries",
                    "formatter": 3,
                    "formatOptions": {
                      "min": 0,
                      "palette": "green"
                    },
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  },
                  {
                    "columnMatch": "Size per Entry",
                    "formatter": 3,
                    "formatOptions": {
                      "min": 0,
                      "palette": "orange"
                    },
                    "numberFormat": {
                      "unit": 2,
                      "options": {
                        "style": "decimal",
                        "maximumFractionDigits": 2
                      }
                    }
                  },
                  {
                    "columnMatch": "IsBillable",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "True",
                          "representation": "green",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "False",
                          "representation": "blueDark",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Estimated Table Price",
                    "formatter": 3,
                    "formatOptions": {
                      "palette": "greenRed"
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  },
                  {
                    "columnMatch": "Table Trend",
                    "formatter": 10,
                    "formatOptions": {
                      "palette": "redGreen"
                    }
                  }
                ],
                "filter": true,
                "sortBy": [
                  {
                    "itemKey": "$gen_heatmap_Last Record Received_1",
                    "sortOrder": 2
                  }
                ],
                "labelSettings": [
                  {
                    "columnId": "Table Name",
                    "label": "Table name"
                  },
                  {
                    "columnId": "Last Record Received",
                    "label": "Last record received",
                    "comment": "When did the last record arrive?"
                  }
                ]
              },
              "sortBy": [
                {
                  "itemKey": "$gen_heatmap_Last Record Received_1",
                  "sortOrder": 2
                }
              ]
            },
            "customWidth": "50",
            "showPin": false,
            "name": "query - 2 - Copy"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "CommonSecurityLog\r\n| summarize last_log = datetime_diff(\"second\",now(), max(TimeGenerated))  by DeviceVendor\r\n| where last_log > {LastLogRecivedThreshold}\r\n| project ['Device Vendor'] = DeviceVendor,  ['Last Record Received'] =  last_log \r\n| order by ['Last Record Received']  desc\r\n\r\n ",
              "size": 0,
              "showAnalytics": true,
              "title": "CommonSecurityLog: Last Data Received by Device Vendor",
              "noDataMessage": "All CEF device vendors ingested logs within specified threshold",
              "noDataMessageStyle": 3,
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "exportFieldName": "Table Name",
              "exportParameterName": "Table",
              "exportDefaultValue": "All Tables",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Last Record Received",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "orangeRed"
                    },
                    "numberFormat": {
                      "unit": 24,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false,
                        "maximumSignificantDigits": 2
                      }
                    }
                  },
                  {
                    "columnMatch": "Table Size",
                    "formatter": 3,
                    "formatOptions": {
                      "min": 0,
                      "palette": "coldHot"
                    },
                    "numberFormat": {
                      "unit": 2,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  },
                  {
                    "columnMatch": "Table Entries",
                    "formatter": 3,
                    "formatOptions": {
                      "min": 0,
                      "palette": "green"
                    },
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  },
                  {
                    "columnMatch": "Size per Entry",
                    "formatter": 3,
                    "formatOptions": {
                      "min": 0,
                      "palette": "orange"
                    },
                    "numberFormat": {
                      "unit": 2,
                      "options": {
                        "style": "decimal",
                        "maximumFractionDigits": 2
                      }
                    }
                  },
                  {
                    "columnMatch": "IsBillable",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "True",
                          "representation": "green",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "False",
                          "representation": "blueDark",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Estimated Table Price",
                    "formatter": 3,
                    "formatOptions": {
                      "palette": "greenRed"
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  },
                  {
                    "columnMatch": "Table Trend",
                    "formatter": 10,
                    "formatOptions": {
                      "palette": "redGreen"
                    }
                  }
                ],
                "filter": true,
                "labelSettings": [
                  {
                    "columnId": "Device Vendor",
                    "label": "Device vendor"
                  },
                  {
                    "columnId": "Last Record Received",
                    "label": "Last record received",
                    "comment": "When did the last record arrive?"
                  }
                ]
              },
              "sortBy": []
            },
            "customWidth": "50",
            "showPin": false,
            "name": "query - 2 - Copy - Copy"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "CommonSecurityLog\r\n| summarize last_log = datetime_diff(\"second\",now(), max(TimeGenerated))  by _ResourceId, Computer\r\n| where last_log > {LastLogRecivedThreshold}\r\n| project ['Azure resource'] = _ResourceId, Computer,  ['Last Record Received'] =  last_log \r\n | order by ['Last Record Received']  desc\r\n ",
              "size": 0,
              "showAnalytics": true,
              "title": "CommonSecurityLog: Last Data Received by Computer",
              "noDataMessage": "All CEF computers ingested logs within specified threshold",
              "noDataMessageStyle": 3,
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "exportFieldName": "Table Name",
              "exportParameterName": "Table",
              "exportDefaultValue": "All Tables",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Last Record Received",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "orangeRed"
                    },
                    "numberFormat": {
                      "unit": 24,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false,
                        "maximumSignificantDigits": 2
                      }
                    }
                  },
                  {
                    "columnMatch": "Table Size",
                    "formatter": 3,
                    "formatOptions": {
                      "min": 0,
                      "palette": "coldHot"
                    },
                    "numberFormat": {
                      "unit": 2,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  },
                  {
                    "columnMatch": "Table Entries",
                    "formatter": 3,
                    "formatOptions": {
                      "min": 0,
                      "palette": "green"
                    },
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  },
                  {
                    "columnMatch": "Size per Entry",
                    "formatter": 3,
                    "formatOptions": {
                      "min": 0,
                      "palette": "orange"
                    },
                    "numberFormat": {
                      "unit": 2,
                      "options": {
                        "style": "decimal",
                        "maximumFractionDigits": 2
                      }
                    }
                  },
                  {
                    "columnMatch": "IsBillable",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "True",
                          "representation": "green",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "False",
                          "representation": "blueDark",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Estimated Table Price",
                    "formatter": 3,
                    "formatOptions": {
                      "palette": "greenRed"
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  },
                  {
                    "columnMatch": "Table Trend",
                    "formatter": 10,
                    "formatOptions": {
                      "palette": "redGreen"
                    }
                  }
                ],
                "filter": true,
                "labelSettings": [
                  {
                    "columnId": "Last Record Received",
                    "label": "Last record received"
                  }
                ]
              },
              "sortBy": []
            },
            "customWidth": "50",
            "showPin": false,
            "name": "query - 2 - Copy - Copy - Copy"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "Syslog\r\n| summarize last_log = datetime_diff(\"second\",now(), max(TimeGenerated))  by _ResourceId, Computer\r\n| where last_log > {LastLogRecivedThreshold}\r\n| project ['Azure resource'] = _ResourceId, Computer,  ['Last Record Received'] =  last_log \r\n | order by ['Last Record Received']  desc\r\n\r\n ",
              "size": 0,
              "showAnalytics": true,
              "title": "Syslog: Last Data Received by Computer",
              "noDataMessage": "All Syslog computers ingested logs within specified threshold",
              "noDataMessageStyle": 3,
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "exportFieldName": "Table Name",
              "exportParameterName": "Table",
              "exportDefaultValue": "All Tables",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Last Record Received",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "orangeRed"
                    },
                    "numberFormat": {
                      "unit": 24,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false,
                        "maximumSignificantDigits": 2
                      }
                    }
                  },
                  {
                    "columnMatch": "Table Size",
                    "formatter": 3,
                    "formatOptions": {
                      "min": 0,
                      "palette": "coldHot"
                    },
                    "numberFormat": {
                      "unit": 2,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  },
                  {
                    "columnMatch": "Table Entries",
                    "formatter": 3,
                    "formatOptions": {
                      "min": 0,
                      "palette": "green"
                    },
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  },
                  {
                    "columnMatch": "Size per Entry",
                    "formatter": 3,
                    "formatOptions": {
                      "min": 0,
                      "palette": "orange"
                    },
                    "numberFormat": {
                      "unit": 2,
                      "options": {
                        "style": "decimal",
                        "maximumFractionDigits": 2
                      }
                    }
                  },
                  {
                    "columnMatch": "IsBillable",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "True",
                          "representation": "green",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "False",
                          "representation": "blueDark",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Estimated Table Price",
                    "formatter": 3,
                    "formatOptions": {
                      "palette": "greenRed"
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  },
                  {
                    "columnMatch": "Table Trend",
                    "formatter": 10,
                    "formatOptions": {
                      "palette": "redGreen"
                    }
                  }
                ],
                "filter": true,
                "labelSettings": [
                  {
                    "columnId": "Last Record Received",
                    "label": "Last record received"
                  }
                ]
              },
              "sortBy": []
            },
            "customWidth": "50",
            "showPin": false,
            "name": "query - 2 - Copy - Copy - Copy - Copy"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityEvent\r\n| where TimeGenerated {TimeRange:query}\r\n| summarize last_log = datetime_diff(\"second\",now(), max(TimeGenerated))  by _ResourceId, Computer\r\n| where last_log > {LastLogRecivedThreshold}\r\n| project ['Azure resource'] = _ResourceId, Computer,  ['Last Record Received'] =  last_log \r\n | order by ['Last Record Received']  desc\r\n ",
              "size": 0,
              "showAnalytics": true,
              "title": "SecurityEvent: Last Data Received by Computer",
              "noDataMessage": "SecurityEvents ingested logs from all computers within specified threshold",
              "noDataMessageStyle": 3,
              "timeContextFromParameter": "TimeRange",
              "showRefreshButton": true,
              "exportFieldName": "Table Name",
              "exportParameterName": "Table",
              "exportDefaultValue": "All Tables",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspace}"
              ],
              "gridSettings": {
                "formatters": [
                  {
                    "columnMatch": "Last Record Received",
                    "formatter": 8,
                    "formatOptions": {
                      "palette": "orangeRed"
                    },
                    "numberFormat": {
                      "unit": 24,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false,
                        "maximumSignificantDigits": 2
                      }
                    }
                  },
                  {
                    "columnMatch": "Table Size",
                    "formatter": 3,
                    "formatOptions": {
                      "min": 0,
                      "palette": "coldHot"
                    },
                    "numberFormat": {
                      "unit": 2,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  },
                  {
                    "columnMatch": "Table Entries",
                    "formatter": 3,
                    "formatOptions": {
                      "min": 0,
                      "palette": "green"
                    },
                    "numberFormat": {
                      "unit": 17,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  },
                  {
                    "columnMatch": "Size per Entry",
                    "formatter": 3,
                    "formatOptions": {
                      "min": 0,
                      "palette": "orange"
                    },
                    "numberFormat": {
                      "unit": 2,
                      "options": {
                        "style": "decimal",
                        "maximumFractionDigits": 2
                      }
                    }
                  },
                  {
                    "columnMatch": "IsBillable",
                    "formatter": 18,
                    "formatOptions": {
                      "thresholdsOptions": "colors",
                      "thresholdsGrid": [
                        {
                          "operator": "==",
                          "thresholdValue": "True",
                          "representation": "green",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "==",
                          "thresholdValue": "False",
                          "representation": "blueDark",
                          "text": "{0}{1}"
                        },
                        {
                          "operator": "Default",
                          "thresholdValue": null,
                          "representation": "blue",
                          "text": "{0}{1}"
                        }
                      ]
                    }
                  },
                  {
                    "columnMatch": "Estimated Table Price",
                    "formatter": 3,
                    "formatOptions": {
                      "palette": "greenRed"
                    },
                    "numberFormat": {
                      "unit": 0,
                      "options": {
                        "style": "decimal",
                        "useGrouping": false
                      }
                    }
                  },
                  {
                    "columnMatch": "Table Trend",
                    "formatter": 10,
                    "formatOptions": {
                      "palette": "redGreen"
                    }
                  }
                ],
                "filter": true,
                "labelSettings": [
                  {
                    "columnId": "Last Record Received",
                    "label": "Last record received",
                    "comment": "When did the last record arrive?"
                  }
                ]
              },
              "sortBy": []
            },
            "customWidth": "50",
            "showPin": false,
            "name": "query - 2 - Copy - Copy - Copy - Copy - Copy"
          }
        ]
      },
      "conditionalVisibility": {
        "parameterName": "Tab",
        "comparison": "isEqualTo",
        "value": "log"
      },
      "name": "group - latency",
      "styleSettings": {
        "showBorder": true
      }
    }
  ],
  "fallbackResourceIds": [
    
  ],
  "fromTemplateId": "sentinel-UserWorkbook",
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}
